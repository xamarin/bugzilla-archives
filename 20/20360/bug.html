<html lang="en"><head>
    <title>20360 – FileStream Read on created Thread hangs the app after time</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style>/* js/yui/assets/skins/sam/autocomplete.css */
.yui-skin-sam .yui-ac{position:relative;font-family:arial;font-size:100%}.yui-skin-sam .yui-ac-input{position:absolute;width:100%}.yui-skin-sam .yui-ac-container{position:absolute;top:1.6em;width:100%}.yui-skin-sam .yui-ac-content{position:absolute;width:100%;border:1px solid #808080;background:#fff;overflow:hidden;z-index:9050}.yui-skin-sam .yui-ac-shadow{position:absolute;margin:.3em;width:100%;background:#000;-moz-opacity:.10;opacity:.10;filter:alpha(opacity=10);z-index:9049}.yui-skin-sam .yui-ac iframe{opacity:0;filter:alpha(opacity=0);padding-right:.3em;padding-bottom:.3em}.yui-skin-sam .yui-ac-content ul{margin:0;padding:0;width:100%}.yui-skin-sam .yui-ac-content li{margin:0;padding:2px 5px;cursor:default;white-space:nowrap;list-style:none;zoom:1}.yui-skin-sam .yui-ac-content li.yui-ac-prehighlight{background:#b3d4ff}.yui-skin-sam .yui-ac-content li.yui-ac-highlight{background:#426fd9;color:#FFF}
/* js/yui/assets/skins/sam/calendar.css */
.yui-calcontainer{position:relative;float:left;_overflow:hidden}.yui-calcontainer iframe{position:absolute;border:0;margin:0;padding:0;z-index:0;width:100%;height:100%;left:0;top:0}.yui-calcontainer iframe.fixedsize{width:50em;height:50em;top:-1px;left:-1px}.yui-calcontainer.multi .groupcal{z-index:1;float:left;position:relative}.yui-calcontainer .title{position:relative;z-index:1}.yui-calcontainer .close-icon{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar{position:relative}.yui-calendar .calnavleft{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar .calnavright{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar .calheader{position:relative;width:100%;text-align:center}.yui-calcontainer .yui-cal-nav-mask{position:absolute;z-index:2;margin:0;padding:0;width:100%;height:100%;_width:0;_height:0;left:0;top:0;display:none}.yui-calcontainer .yui-cal-nav{position:absolute;z-index:3;top:0;display:none}.yui-calcontainer .yui-cal-nav .yui-cal-nav-btn{display:-moz-inline-box;display:inline-block}.yui-calcontainer .yui-cal-nav .yui-cal-nav-btn button{display:block;*display:inline-block;*overflow:visible;border:0;background-color:transparent;cursor:pointer}.yui-calendar .calbody a:hover{background:inherit}p#clear{clear:left;padding-top:10px}.yui-skin-sam .yui-calcontainer{background-color:#f2f2f2;border:1px solid #808080;padding:10px}.yui-skin-sam .yui-calcontainer.multi{padding:0 5px 0 5px}.yui-skin-sam .yui-calcontainer.multi .groupcal{background-color:transparent;border:0;padding:10px 5px 10px 5px;margin:0}.yui-skin-sam .yui-calcontainer .title{background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;border-bottom:1px solid #ccc;font:100% sans-serif;color:#000;font-weight:bold;height:auto;padding:.4em;margin:0 -10px 10px -10px;top:0;left:0;text-align:left}.yui-skin-sam .yui-calcontainer.multi .title{margin:0 -5px 0 -5px}.yui-skin-sam .yui-calcontainer.withtitle{padding-top:0}.yui-skin-sam .yui-calcontainer .calclose{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -300px;width:25px;height:15px;top:.4em;right:.4em;cursor:pointer}.yui-skin-sam .yui-calendar{border-spacing:0;border-collapse:collapse;font:100% sans-serif;text-align:center;margin:0}.yui-skin-sam .yui-calendar .calhead{background:transparent;border:0;vertical-align:middle;padding:0}.yui-skin-sam .yui-calendar .calheader{background:transparent;font-weight:bold;padding:0 0 .6em 0;text-align:center}.yui-skin-sam .yui-calendar .calheader img{border:0}.yui-skin-sam .yui-calendar .calnavleft{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -450px;width:25px;height:15px;top:0;bottom:0;left:-10px;margin-left:.4em;cursor:pointer}.yui-skin-sam .yui-calendar .calnavright{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -500px;width:25px;height:15px;top:0;bottom:0;right:-10px;margin-right:.4em;cursor:pointer}.yui-skin-sam .yui-calendar .calweekdayrow{height:2em}.yui-skin-sam .yui-calendar .calweekdayrow th{padding:0;border:0}.yui-skin-sam .yui-calendar .calweekdaycell{color:#000;font-weight:bold;text-align:center;width:2em}.yui-skin-sam .yui-calendar .calfoot{background-color:#f2f2f2}.yui-skin-sam .yui-calendar .calrowhead,.yui-skin-sam .yui-calendar .calrowfoot{color:#a6a6a6;font-size:85%;font-style:normal;font-weight:normal;border:0}.yui-skin-sam .yui-calendar .calrowhead{text-align:right;padding:0 2px 0 0}.yui-skin-sam .yui-calendar .calrowfoot{text-align:left;padding:0 0 0 2px}.yui-skin-sam .yui-calendar td.calcell{border:1px solid #ccc;background:#fff;padding:1px;height:1.6em;line-height:1.6em;text-align:center;white-space:nowrap}.yui-skin-sam .yui-calendar td.calcell a{color:#06c;display:block;height:100%;text-decoration:none}.yui-skin-sam .yui-calendar td.calcell.today{background-color:#000}.yui-skin-sam .yui-calendar td.calcell.today a{background-color:#fff}.yui-skin-sam .yui-calendar td.calcell.oom{background-color:#ccc;color:#a6a6a6;cursor:default}.yui-skin-sam .yui-calendar td.calcell.oom a{color:#a6a6a6}.yui-skin-sam .yui-calendar td.calcell.selected{background-color:#fff;color:#000}.yui-skin-sam .yui-calendar td.calcell.selected a{background-color:#b3d4ff;color:#000}.yui-skin-sam .yui-calendar td.calcell.calcellhover{background-color:#426fd9;color:#fff;cursor:pointer}.yui-skin-sam .yui-calendar td.calcell.calcellhover a{background-color:#426fd9;color:#fff}.yui-skin-sam .yui-calendar td.calcell.previous{color:#e0e0e0}.yui-skin-sam .yui-calendar td.calcell.restricted{text-decoration:line-through}.yui-skin-sam .yui-calendar td.calcell.highlight1{background-color:#cf9}.yui-skin-sam .yui-calendar td.calcell.highlight2{background-color:#9cf}.yui-skin-sam .yui-calendar td.calcell.highlight3{background-color:#fcc}.yui-skin-sam .yui-calendar td.calcell.highlight4{background-color:#cf9}.yui-skin-sam .yui-calendar a.calnav{border:1px solid #f2f2f2;padding:0 4px;text-decoration:none;color:#000;zoom:1}.yui-skin-sam .yui-calendar a.calnav:hover{background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;border-color:#a0a0a0;cursor:pointer}.yui-skin-sam .yui-calcontainer .yui-cal-nav-mask{background-color:#000;opacity:.25;filter:alpha(opacity=25)}.yui-skin-sam .yui-calcontainer .yui-cal-nav{font-family:arial,helvetica,clean,sans-serif;font-size:93%;border:1px solid #808080;left:50%;margin-left:-7em;width:14em;padding:0;top:2.5em;background-color:#f2f2f2}.yui-skin-sam .yui-calcontainer.withtitle .yui-cal-nav{top:4.5em}.yui-skin-sam .yui-calcontainer.multi .yui-cal-nav{width:16em;margin-left:-8em}.yui-skin-sam .yui-calcontainer .yui-cal-nav-y,.yui-skin-sam .yui-calcontainer .yui-cal-nav-m,.yui-skin-sam .yui-calcontainer .yui-cal-nav-b{padding:5px 10px 5px 10px}.yui-skin-sam .yui-calcontainer .yui-cal-nav-b{text-align:center}.yui-skin-sam .yui-calcontainer .yui-cal-nav-e{margin-top:5px;padding:5px;background-color:#edf5ff;border-top:1px solid black;display:none}.yui-skin-sam .yui-calcontainer .yui-cal-nav label{display:block;font-weight:bold}.yui-skin-sam .yui-calcontainer .yui-cal-nav-mc{width:100%;_width:auto}.yui-skin-sam .yui-calcontainer .yui-cal-nav-y input.yui-invalid{background-color:#ffee69;border:1px solid #000}.yui-skin-sam .yui-calcontainer .yui-cal-nav-yc{width:4em}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn{border:1px solid #808080;background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;background-color:#ccc;margin:auto .15em}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn button{padding:0 8px;font-size:93%;line-height:2;*line-height:1.7;min-height:2em;*min-height:auto;color:#000}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn.yui-default{border:1px solid #304369;background-color:#426fd9;background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 -1400px}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn.yui-default button{color:#fff}
/* skins/standard/global.css */
body {font-family: sans-serif;color: #000;background: #fff url(../../skins/standard/global/body-back.gif) repeat-x;}body, td, th, input, dt, #titles {font-family: Verdana, sans-serif;font-size: small;}pre, code, kbd {font-size: medium;}#bugzilla-body {clear: both;}#bugzilla-body th {font-weight: bold;vertical-align: top;}#header {margin-bottom: 1em;}#header form, #header form input,#footer form, #footer form input{font-size: 95%;display: inline;}#header .links {border-left: 1px solid #747E93;border-right: 1px solid #747E93;border-bottom: 1px solid #747E93;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;padding: 0.5em;}#lang_links_container {float: right;white-space: nowrap;}#lang_links_container .links {border: none;padding: .5em;}.lang_current {font-weight: bold;}#message {border: 1px solid red;margin: 0.3em 0em;padding: 0.3em;color: green;}form.mini_login input.bz_login  {width: 10em;}form.mini_login input.bz_password {width: 6em;}form.mini_login input.bz_remember {margin: 0;}#banner {}#titles {width: 100%;background-color: #404D6C;color: #fff;border-top-left-radius: 5px;border-top-right-radius: 5px;margin: 0;vertical-align: bottom;display: table;}#titles a {color: #fff;}#titles p {margin: 0;padding: 0;}#titles #title {font-weight: bold;padding: 0.5em;white-space: nowrap;display: table-cell;}#titles #subtitle {font-weight: normal;text-align: center;padding: 0.5em;display: table-cell;}#titles #information {font-weight: normal;text-align: right;font-size: 90%;padding: 0.5em;white-space: nowrap;display: table-cell;}#footer {clear: both;margin-top: 1em;width: 100%;background: #edf2f2;border-top: 1px solid #ddd;border-bottom: 1px solid #ddd;}#footer #useful-links {padding-left: 1ex;padding-right: 1ex;}#footer ul {list-style-type: none;}#links-saved ul {display: inline;}#links-saved th {vertical-align: top;}#footer .label {white-space: nowrap;vertical-align: top;}#footer .links {vertical-align: top;}ul.links {margin: 0;padding: 0;list-style-type: none;}ul.links li {display: inline;white-space: nowrap;}table.tabs {width: 100%;}.tabs th, .tabs td {padding: 1em;}.tabs td {background: #eee;text-align: center;border-style: solid;border-color: black;border-width: 0px 0px 2px 0px;}.tabs td.selected {background: white;border-width: 2px 2px 0px 2px;}.tabs td.spacer {background: white;}a {color: #039;}a:visited {color: #636;}a:hover {color: #333;}a:active {color: #000;}.clickable_area {cursor: pointer;}textarea {font-family: monospace;}a.controller {font-size: 115%;}div#docslinks {float: right;border: 1px solid black;padding: 1ex;font-size: 80%;}#docslinks h2 {margin: 0;}.rss {background: transparent url(../../skins/standard/../../images/rss_small.png) no-repeat;padding-left: 16px;line-height: 1.5em;}.bz_bug_link {}.bz_bug_link.bz_status_UNCONFIRMED {font-style: italic;}.bz_obsolete {text-decoration: line-through;}.bz_inactive {text-decoration: line-through;}.bz_closed,.bz_CLOSED td {text-decoration: line-through;}.bz_private {color: darkred;background: #f3eeee;}.bz_disabled {color: #a0a0a0;}.bz_comment_table td {vertical-align: top;}.bz_comment {margin-bottom: 2em;}.bz_comment_text, .uneditable_textarea, tbody.file pre {font-family: monospace;white-space: pre-wrap;}.bz_comment_text {width: 50em;}.bz_comment_text span.quote {color: #65379c;white-space: pre;overflow: auto;display: block;}.bz_comment_user, .bz_comment_time, .bz_comment_number,.bz_private_checkbox, .bz_comment_actions{margin: 0 .5em;}.bz_comment_actions, .bz_comment_number, .bz_private_checkbox {float: right;}.bz_collapse_expand_comments {padding: 0;margin: 0 0 0 1em;list-style-type: none;}.bz_collapse_expand_comments li {margin-bottom: .5em;}.bz_collapse_comment {text-decoration: none;}.bz_private_checkbox input {margin: 0;vertical-align: middle;}.bz_comment_head, .bz_first_comment_head {padding-top: .1em;padding-bottom: .1em;padding-left: .5em;background-color: #e0e0e0;}.bz_comment_user_images img {vertical-align: bottom;}.bz_comment_hilite pre {background-color: lightgreen;margin: 0;padding: 1em 0;}.bz_comment_collapse_reason,.bz_default_collapsed .bz_comment_number {font-weight: normal;}.bz_default_hidden, .bz_tui_hidden, .bz_hidden_field, .bz_hidden_option {display: none !important;}table#flags th,table#flags td {vertical-align: middle;text-align: left;}#email_prefs, #saved_search_prefs, #shared_search_prefs,#bug_activity {border: 1px solid black;border-collapse: collapse;}#email_prefs th,#shared_search_prefs th,#saved_search_prefs th {text-align: center;}#email_prefs th, #email_prefs td,#shared_search_prefs th, #shared_search_prefs td,#saved_search_prefs th, #saved_search_prefs td,#bug_activity td {border: 1px solid;padding: 0.3em;}#email_prefs th.role_header {width: 10%;}#bug_activity td {vertical-align: top;}#user_prefs th, #user_prefs td {padding: 0.5em;}#permissions {margin-left: auto;margin-right: auto;width: 40em;}#permissions p {margin-top: 2em;margin-bottom: 0.5em;}#permissions li {list-style-type: none;}#permissions table td {vertical-align: top;}.column_header {background-color: #66f;}.column_header th {text-align: center;}.flag_select {min-width: 3em;}input.requestee {width: 15em;}#error_msg {font-size: x-large;}#post_err_msg, form#check {clear: both;}.warning {color: red;}.throw_error {background-color: red;color: black;font-size: 120%;margin-bottom: 2em;padding: 0.5em 1em;float: left;}.label {font-weight: bold;}.throw_error a:visited {color: darkblue ;}dt {font-weight: bold;}body > dl > dt {border-top: dotted gray thin;}dl dl > dt {border-top: none;}.arrow_button {font-size: 150%;}#attachment_table {border-collapse: collapse;border: 1px solid #333333;}#attachment_table th, .bz_attach_footer, .bz_time_tracking_table th,.dependency_tree_controls {background-color: #E0E0E0;color: black;}#attachment_table td, .bz_time_tracking_table th, .bz_time_tracking_table td {border: 1px solid #333333;}#attachment_table th, #attachment_table td {padding: 0.3em;}.bz_attach_extra_info, .bz_info {font-size: smaller;}.bz_attach_flags, .bz_attach_footer, .bz_flags, .nowrap {white-space: nowrap;}.bz_attach_view_hide {float: right;padding-left: 1em;}#user_match_table {border-collapse: collapse;}#user_match_table td {vertical-align: top;border-bottom: 1px solid black;padding: 1em 0.5em;}div.user_match {margin-bottom: 1em;}.indented {margin-left: 3em;}.box {border: 1px solid black;color: black;background-color: #ffc;margin: 1em;padding: 0.5em 1em;}.collapsed,.bz_default_collapsed .bz_private_checkbox,.bz_default_collapsed .bz_comment_user,.bz_default_collapsed .bz_comment_user_images,.bz_default_collapsed .bz_comment_time,.bz_default_collapsed .bz_comment_tags,.bz_default_collapsed .bz_comment_text,.bz_default_collapsed .bz_collapsed_actions{display: none;}#serverpush_msg {margin-top: 20%;text-align: center;font-size: xx-large;}@media print {#header, #footer {display: none;}div.bz_query_buttons {display: none;}body {background-image: none;background-color: #fff;}}.field_label {text-align: right;vertical-align: top;font-weight: bold;}.field_help_link {cursor: help;}.field_value, form#Create th, form#Create td, .top {vertical-align: top;}.bottom {vertical-align: bottom;}.field_value .text_input {width: 100%;min-width: 25em;}.uneditable_textarea {max-width: 30em;font-size: medium;}th.required:before {content: "* ";}th.required:before, span.required_star {color: red;}input.required, select.required, span.required_explanation {background-color: #fff7cd;color: #000;}.calendar_button {background: transparent url(../../skins/standard/global/calendar.png) no-repeat;width: 20px;height: 20px;vertical-align: middle;}.calendar_button span { display: none }.yui-calcontainer {display: none;background-color: white;padding: 10px;border: 1px solid #404D6C;}.bug_urls {margin: 0;padding: 0;list-style-type: none;}pre.field_textarea_readonly {margin: 2px;padding: 4px;overflow: auto;float: left;max-width: 30em;max-height: 7em;border: 1px solid #CCC;font-family: monospace;white-space: pre-wrap;}.yui-skin-sam .yui-ac-input { position:static !important;vertical-align:middle !important; }.yui-skin-sam .yui-ac-container { left:0px !important; }.yui-skin-sam .yui-ac { display: inline-block; }#bugzilla-body .yui-ac-content {max-height: 19em;overflow: auto;overflow-x: hidden;}#keywords_container {padding-top: .2em;}#keywords_container .yui-ac-content {margin-left: -1px;}#comment_tabs {border-spacing: 0;}.comment_tab {display: table-cell;border: 1px solid silver;padding: 2px 1em;cursor: pointer;background: transparent;}.active_comment_tab {background: #fff;font-weight: bold;}#comment_preview {border: 1px solid silver;padding: 1px;overflow: auto;margin: 0px;}#comment_preview_text {margin: 0px;width: auto;}#comment_preview_loading {font-style: italic;}#comment {margin: 0px 0px 1em 0px;}.validation_error_text {font-size: 120%;color: #B70000;font-weight: bold;}.validation_error_field, input.validation_error_field {border: 2px solid #B70000;background-color: #FFEBEB;}form th {text-align: right;}.left {text-align: left;}.center {text-align: center;}.right {text-align: right;}.middle {vertical-align: middle;}.inline {display: inline;}tr.shared_search {background-color: #fff7cd;color: #000;}.multi-columns {columns: 3;-moz-columns: 3;-webkit-columns: 3;}#page-index {padding: 0.2em 0.2em 0.15em 0.2em;max-width: 1000px;}.intro, .outro {text-align: center;}#new_release {border: 2px solid red;padding: 0.5em 1em;margin: 1em;font-weight: bold;}#new_release .notice {font-size: 80%;font-weight: normal;}#welcome-admin a {font-weight: bold;}.bz_common_actions {text-align: center;}.bz_common_actions ul {list-style-type: none;padding: 0;}.bz_common_actions ul li {display: inline;vertical-align: top;}.bz_common_actions ul li a {display: inline-block;height: 170px;width: 145px;margin: 0 2ex 2em 0;}.bz_common_actions ul li a span {position: relative;top: 90%;font-weight: bold;}.bz_common_actions a,.bz_common_actions a:visited,.bz_common_actions a:hover {text-decoration: none;}#enter_bug { background: url(../../skins/standard/index/file-a-bug.png)  no-repeat; }#query     { background: url(../../skins/standard/index/search.png)      no-repeat; }#account   { background: url(../../skins/standard/index/new-account.png) no-repeat; }#help      { background: url(../../skins/standard/index/help.png)        no-repeat; }#quicksearchForm {clear: both;text-align: center;margin-bottom: 2em;}#quicksearchForm #quicksearch_main {width: 27em;}#quicksearchForm {margin: 0;padding: 0;}#page-index table {border-collapse: collapse;margin: auto;}#welcome {font-size: x-large;font-weight: bold;text-align: center;margin: 0 0 0.8em 0;padding: 0;}#common_queries ul {list-style: none;padding-left: 1.5em;}#common_queries li a {text-decoration: none;}ul#quicksearch_links {margin-bottom: 1em;}ul.additional_links {list-style: none;margin: 0;padding: 0;}ul.additional_links li {display: inline;}ul.additional_links li.bz_default_hidden {display: none;}body.narrow_page #bugzilla-body > * {max-width: 45em;}.req_new {color: red;}.req_table {border-collapse: collapse;}.req_table td, .req_table th {border: 1px solid black;padding: .25em;}.qs_help li {margin-top: 1ex;}.qs_fields th {padding: 0 .25em;}.qs_fields th.field_nickname {text-align: left;}.qs_fields td {padding: .25em;border-top: 1px solid gray;}.qs_fields .field_name {width: 10em;}table.field_value_explanation {table-layout: fixed;border-collapse: collapse;}.field_value_explanation thead h2 {margin: 0;}.field_value_explanation .header_row td {text-align: center;font-size: 120%;font-weight: bold;}.field_value_explanation tbody td {border: 1px solid black;padding: 1em;}.field_value_explanation dt, .field_descriptions dt {margin-top: 1em;}.field_descriptions dt {font-size: 120%;}#duplicates_table {border-collapse: collapse;}#duplicates_table .resolved {background-color: #d9d9d9;color: black;}#duplicates_table thead tr {background-color: #ccc;color: black;}#duplicates_table thead tr th {vertical-align: middle;}#duplicates_table td, #duplicates_table th {border: 1px solid black;padding: .1em .25em;}#duplicates_table tbody td {text-align: center;}#duplicates_table tbody td.short_desc {text-align: left;}
/* skins/standard/bug.css */
.enter_bug_form table {border-spacing: 0;border-width: 0;}.enter_bug_form td, .enter_bug_form th {padding: .25em;}.enter_bug_form th {text-align: right;}#Create #field_container_component {width: 1px;}#Create #field_container_reporter {width: 100%;}#Create .comment, #guided_form #description {vertical-align: top;overflow: auto;color: green;}#guided_form #description {display: inline;margin-left: 10px;}#Create #comp_desc_container td {padding: 0;}#Create #comp_desc {height: 11ex;}#Create #os_guess_note {padding-top: 0;}#Create #os_guess_note div {max-width: 35em;}#Create .field_value .text_input {max-width: 50em;}#possible_duplicates th {text-align: center;background: none;border-collapse: collapse;}#possible_duplicates td {vertical-align: middle;}#possible_duplicates .yui-dt-col-update_token {white-space: nowrap;}table#flags th, table#flags td,table#bug_flags th, table#bug_flags td,table#attachment_flags th, table#attachment_flags td {text-align: left;vertical-align: baseline;font-size: small;}.guided_form_field {background-color: #ffc;}#somebugs {width: 100%;height: 500px;}.good {color: #090;}.bad {color: #900;}.bz_short_desc_container {margin: 8px 0;padding: 0.3em;background-color: rgb(208, 208, 208);border-radius: 0.5em;font-size: 125%;font-weight: bold;}.bz_bug .edit_form {width: 100%;}.bz_bug .edit_form table {width: 100%;}.bz_bug #alias {min-width: 0;width: 10em;}table#flags {width: auto;}.bz_column_spacer {width: 0.5em;}.related_actions {font-size: 0.85em;float: right;list-style-type: none;white-space: nowrap;margin: 0;padding: 0;}.related_actions li {display: inline;}.navigation_link {color: #777;font-style: italic;}.bz_show_bug_column {vertical-align: top;}.bz_section_spacer {height: 1em;}#duplicate_settings {white-space: nowrap;}#bz_big_form_parts td {vertical-align: top;}.bz_group_visibility_section {margin-left: 1em;}.bz_group_visibility_section .instructions {font-style: italic;}#bz_restrict_group_visibility_help .instructions {margin-top: 0;}#bz_enable_role_visibility_help {margin-top: 1em;}.bz_time_tracking_table {border-collapse: collapse;}.bz_time_tracking_table th {text-align: center;}.bz_time_tracking_table td {text-align: center;}.bz_time_tracking_table th,.bz_time_tracking_table td {padding: 4px;}.bz_time_tracking_table .bz_summarize_time {text-align: right;}.bz_time_tracking_table #deadline {width: 7em;}#summary tr td {vertical-align:top;}#status {margin-bottom: 3ex;}.knob-buttons {float: right;}.text_input, .bz_userfield, #keywords_container, #tag_container {width: 100%;}.bz_bug .bz_short_desc_container {width: inherit;}.bz_comment_tags {margin-top: 3px;}.bz_comment_tag {border: 1px solid #c8c8ba;padding: 1px 3px;margin-right: 2px;border-radius: 0.5em;background-color: #eee;color: #000;}#bz_ctag_div {display: inline-block;}#bz_ctag_error {border: 1px solid #ff6666;padding: 0px 2px;border-radius: 0.5em;margin: 2px;display: inline-block;}#comment_tags_collapse_expand_container {padding-top: 1em;}#comment_tags_collapse_expand {list-style-type: none;padding-left: 1em;}#comment_tags_collapse_expand li {margin-bottom: 0px;}ul.tree {padding-left: 0em;margin-left: 1em;display: block;}ul.tree ul {padding-top: 3px;display: block;}ul.tree li {padding-top: 3px;text-indent: -1.2em;padding-left: 0.5em;padding-bottom: 3px;list-style-type: none;background: url(../../skins/standard/dependency-tree/bug-item.png) no-repeat;}ul.tree li a.b {padding-left: 30px;margin-right: -14px;text-decoration: none;}ul.tree li a.b_open {background: url(../../skins/standard/dependency-tree/tree-open.png) center no-repeat;cursor: pointer;}ul.tree li a.b_closed {background: url(../../skins/standard/dependency-tree/tree-closed.png) center no-repeat;cursor: pointer;}ul.tree a.tree_link img {border: 0;}.summ_info {display: none;font-size: 75%;}.hint {font-size: 90%;margin: 0.2em;padding: 0.1em;}.hint h3, .hint ul {margin-top: 0.1em;margin-bottom: 0.1em;}.summ A, .summ_deep A {text-decoration: none;color: darkblue;}.summ_h A {background-color: #ffffaa;color: #333;font-weight: bold;}.dependency_tree_controls input[type=submit] {min-width: 3em;}table.attachment_entry th {text-align: right;vertical-align: baseline;white-space: nowrap;}table.attachment_entry td {text-align: left;vertical-align: baseline;padding-bottom: 5px;}.file_head {font-weight: bold;font-size: 1em;background-color: #c3c3c3;border: 1px solid black;}.file_head a {text-decoration: none;font-family: monospace;font-size: 1.1em;}.file_collapse {display: none;}.section_head {background-color: #f0f0f0;border: 1px solid black;text-align: left;padding: 0.2em;}.section_head .link_here {float: right;padding-left: 1em;padding-right: 0.5em;}.lines_count a {padding-left: 0.5em;padding-right: 1em;}table.file_table {table-layout: fixed;width: 100%;empty-cells: show;border-spacing: 0px;border-collapse: collapse;border-bottom: 1px solid black;}tbody.file pre {display: inline;font-size: 0.9em;}tbody.file pre:empty {display: block;}.changed {background-color: lightblue;}.added {background-color: lightgreen;}.removed {background-color: #FFCC99;}.num {background-color: #ffe9ae;text-align:right;padding: 0 0.3em;width: 3em;}table.attachment_info th {text-align: right;vertical-align: top;}table.attachment_info td {text-align: left;vertical-align: top;}#noview {text-align: left;vertical-align: middle;}#attachment_attributes div {padding-bottom: 0.4em;}#attachment_attributes label {font-weight: bold;}#attachment_attributes .block {display: block;}#smallCommentFrame, #attachment_flags {float: left;}#smallCommentFrame {margin-right: 1.5em;}#attachment_comments_and_flags, #attachment_actions {clear: both;margin-bottom: 1ex;}#attachment_information_read_only .title {font-weight: bold;font-size: 1.5em;padding: 0;margin: 0;}#attachment_information_read_only .title #bz_edit {font-size: 0.7em;}#attachment_information_read_only .details {font-size: 90%;}#attachment_info.read #attachment_information_edit {display: none;}#attachment_info.edit #attachment_information_read_only {display: none;}#attachment_info.edit #attachment_view_window {float: left;width: 80%;}#attachment_info.edit #attachment_information_edit {width: 20%;}#attachment_info.edit #attachment_information_edit input.text,#attachment_info.edit #attachment_information_edit textarea {width: 90%;}#attachment_isobsolete {padding-right: 1em;}#attachment_information_edit {float: left;}#smallCommentFrame textarea {display: block;}textarea.bz_private {border: 1px solid #F8C8BA;}#update {clear: both;display: block;}div#update_container {clear: both;padding: 1.5em 0;}#attachment_flags {margin-bottom: 1em;}#attachment_flags p {padding-bottom: 0;margin-bottom: 0;}#editFrame, #viewDiffFrame, #viewFrame {height: 400px;width: 95%;margin-left: 2%;}.viewall_frame_container {width: 75%;margin: 2em auto;}.viewall_desc {width: 100%;border: 1px solid black;border-spacing: 0px;border-collapse: collapse;}.viewall_desc th, .viewall_desc td {border: 1px solid black;padding: 0.3em;}.viewall_frame {width: 100%;height: 350px;}.no_javascript .bz_hide, .no_javascript .bz_edit {display: none;}#hidden_obsolete_message {text-align: left;width: 75%;margin: 0  auto;font-weight: bold;}
/* skins/contrib/Dusk/global.css */
body {background: #c8c8c8;font-family: Helvetica, Arial, Geneva;padding-left: 1em;padding-right: 1em;}#titles {border-top-left-radius: 5px;border-top-right-radius: 5px;}#header .links, #footer {background-color: #929bb1;color: #ddd;}#header {border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;border: none;}#header a, #footer a {color: white;text-decoration: none;}#header a:hover, #footer a:hover {text-decoration: underline;}#bugzilla-body {background: #f0f0f0;color: black;border: 1px solid #747e93;padding: 10px;font-size: 10pt;border-radius: 5px;}a {color: #6070cf;}a:hover {color: #8090ef;}hr {border-color: #969696;border-style: dashed;border-width: 1px;margin-top: 10px;}#bug-form td {padding-top: 2px;}#attachment-list {border: 2px solid #c8c8ba;font-size: 9pt;}#attachment-list th {background-color: #e6e6d8;border: none;border-bottom: 1px solid #c8c8ba;text-align: left;}#attachment-list th a {color: #646456;}#attachment-list td {border: none;}#attachment-list-actions td {border-top: 1px solid #c8c8ba;}#comments th {font-size: 9pt;font-weight: bold;padding-top: 5px;padding-right: 5px;padding-bottom: 10px;text-align: right;vertical-align: top;white-space: nowrap;}#comments td {padding-top: 2px;}.reply-button a {padding-left: 2px;padding-right: 2px;}.bz_comment {background-color: #e8e8e8;margin: 1px 1px 10px 1px;border-width: 1px;border-style: solid;border-color: #c8c8ba;padding: 5px;font-size: 9pt;}.bz_comment_head, .bz_first_comment_head {margin: 0; padding: 0;background-color: transparent;font-weight: bold;}.bz_comment_user {margin-left: 0;}.bz_comment.bz_private {background-color: #f0e8e8;border-color: #f8c8ba;}.comment_rule {display: none;}#footer {border: 1px solid #747e93;width: 100%;border-radius: 5px;}#footer #links-actions,#footer #links-edit,#footer #links-saved,#footer #links-special {margin-top: 2ex;}#footer .links {border-spacing: 30px;margin-bottom: 2ex;}.separator {color: #cccccc;}.tabbed .tabbody {background: #f8f8f8;padding: 1em;border-style: solid;border-color: #000000;border-width: 0 3px 3px 1px;}.tabs {margin: 0;padding: 0;border-collapse: collapse;}.tabs td {background: #c8c8c8;border-width: 1px;}.tabs td.selected {background: #f8f8f8;border-width: 1px 3px 0 1px;}.tabs td.spacer {background: transparent;border-top: none;border-left: none;border-right: none;}.bz_row_odd {background-color: #f0f0f0;}#page-index .outro {clear:both;}@media print {#header,#footer,.navigation {display: none;}body {background-image: none;background-color: #ffffff;}#bugzilla-body {border: none;margin: 0;padding: 0;}}
</style>

<style>/* skins/custom/global.css */
#banner > div {border-radius: 5px;}#banner a {color: #6070cf}
</style>

    


    


    

    
    <link rel="search" type="application/opensearchdescription+xml" title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><link href="https://c.s-microsoft.com/mscc/statics/mscc-0.4.1.min.css" rel="stylesheet" type="text/css">

      

    <style>.wrapper {
    margin: 0 auto;
    box-sizing: border-box;
    -ms-box-sizing: border-box;
}

#global-footer {
    background-color: #354b60;
}

#global-footer li,#global-footer ul {
    list-style: none;
    padding: 0;
    border: 0;
    margin: 0;
    font: inherit;
    color: inherit;
    line-height: normal
}

#global-footer footer {
    margin-top: 60px;
    background: rgba(44,62,80,.5);
    clear: both;
    padding: 30px;
    margin: 0;
    font-size: 14px;
    color: #ecf0f1;
}

#global-footer footer .wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    /* align-items:center; */
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
}

#global-footer footer .microsoft-logo img {
    display: block;
    margin: 0 auto;
    width: 110px;
}

#global-footer footer .contact {
    text-align: left
}

#global-footer footer .legal {
    text-align: right
}

#global-footer footer a,#global-footer footer span {
    padding: 0 10px
}

#global-footer footer a {
    color: inherit;
    text-decoration: none;
}

#global-footer footer a:hover {
    color: #fff;
    text-decoration: none;
}

#global-footer .sub-footer {
    background-color: #233140;
    color: hsla(0,0%,100%,.7);
    font-size: 14px;
    padding: 3px;
    -webkit-font-smoothing: antialiased;
    -moz-font-smoothing: antialiased
}

@media (max-width: 992px) {
    html:not(.non-responsive) #global-footer footer {
        padding:0
    }

    html:not(.non-responsive) #global-footer footer .wrapper {
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        max-width: 430px
    }

    html:not(.non-responsive) #global-footer footer .microsoft-logo {
        -webkit-box-ordinal-group: 1;
        -ms-flex-order: 0;
        order: 0
    }

    html:not(.non-responsive) #global-footer footer .wrapper>:not(.microsoft-logo) {
        -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
        order: 1
    }

    html:not(.non-responsive) #global-footer footer .contact,html:not(.non-responsive) #global-footer footer .legal,html:not(.non-responsive) #global-footer footer .microsoft-logo {
        float: none;
        padding: 20px 0;
        text-align: center
    }

    html:not(.non-responsive) #global-footer footer .contact,html:not(.non-responsive) #global-footer footer .legal {
        padding-top: 0
    }
}
</style>
  </head>

  <body class="bugzilla-xamarin-com
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Android
                 bz_component_Mono_runtime___AOT_Compiler
                 bz_bug_20360 yui-skin-sam">

  <div id="header">

    <div id="titles">
      <span id="title">Bugzilla – Bug&nbsp;20360</span>

        <span id="subtitle" class="subheader">FileStream Read on created Thread hangs the app after time</span>

        <span id="information" class="header_addl_info">Last modified: 2014-08-20 10:22:41 UTC</span>
    </div>


    <div id="common_links">
    </div>
  </div>

  <div id="bugzilla-body">




<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-08-20 10:22:41">
  <input type="hidden" name="id" value="20360">
  <input type="hidden" name="token" value="1559201566-MVBmajYT4kndJ8CnQBSH-R6olCiu-X1szYIcBUQnXD8">
<div class="bz_short_desc_container edit_form">
     <a href="bug.html"><b>Bug&nbsp;20360</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">FileStream Read on created Thread hangs the app after time</span>
     </span>

    <div id="summary_input"><span class="field_label " id="field_label_short_desc">


  <a title="The bug summary is a short sentence which succinctly describes what the bug is about." class="field_help_link" href="#">Summary:</a>

</span>FileStream Read on created Thread hangs the app after time
    </div>
  </div>
  
  <table class="edit_form">
    <tbody><tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">
        <table>
          <tbody><tr>
    <th class="field_label">
      <a href="#">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_alias">


  <a title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla." class="field_help_link" href="#">Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_product">


  <a title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list." class="field_help_link" href="#">Product:</a>

</th>
  <td class="field_value " id="field_container_product">Android

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label " id="field_label_classification">


  <a title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation." class="field_help_link" href="#">Classification:</a>

</th>
  <td class="field_value " id="field_container_classification">Xamarin

</td>
    </tr>
    
    
    
    <tr><th class="field_label " id="field_label_component">


  <a title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list." class="field_help_link" href="#">Component:</a>

</th>
  <td class="field_value " id="field_container_component">Mono runtime / AOT Compiler

  ()
</td>
    </tr>
    <tr><th class="field_label " id="field_label_version">


  <a title="The version field defines the version of the software the bug was found in." class="field_help_link" href="#">Version:</a>

</th>
<td>4.12.4
  </td>
    </tr>
    
    
    
    <tr><th class="field_label " id="field_label_rep_platform">


  <a title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;." class="field_help_link" href="#">Hardware:</a>

</th>
      <td class="field_value">PC
        Windows
      </td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
      <th class="field_label">
        <label accesskey="i">
          <a href="#"><u>I</u>mportance</a></label>:
      </th>
      <td>High
       normal
      </td>
    </tr>

      <tr><th class="field_label " id="field_label_target_milestone">


  <a title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it." class="field_help_link" href="#">Target Milestone:</a>

</th><td>---
  </td>
      </tr>

          <tr><th class="field_label " id="field_label_assigned_to">


  <a title="The person in charge of resolving the bug." class="field_help_link" href="#">Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Marek Habersack</span>
</span>
      </td>
    </tr>

    
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_bug_file_loc">


  <a title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen." class="field_help_link" href="#">URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label " id="field_label_dependson">


  <a title="The bugs listed here must be resolved before this bug can be resolved." class="field_help_link" href="#">Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>

  <tr><th class="field_label " id="field_label_blocked">


  <a title="This bug must be resolved before the bugs listed in this field can be resolved." class="field_help_link" href="#">Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>

        </tbody></table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tbody><tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2014-06-04 19:54 UTC by <span class="vcard"><span class="fn">Rowan</span>
</span>
    </td>
  </tr>

  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2014-08-20 10:22 UTC
      (<a href="activity.html">History</a>)
    </td>

  </tr>
<tr>
      <th class="field_label">
        <label accesskey="a">
          CC List:
        </label>
      </th>
      <td>6
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="frederic.rudman">frederic.rudman</option>
                <option value="mono-bugs+monodroid">mono-bugs+monodroid</option>
                <option value="severo">severo</option>
                <option value="tajinders">tajinders</option>
                <option value="tj">tj</option>
                <option value="udhams">udhams</option>
            </select>
        </div>
          
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr>
      <th class="field_label " id="field_label_cf_tags">


  <a title="A custom Free Text field in this installation of Bugzilla." class="field_help_link" href="#">Tags:</a>

</th>
  <td class="field_value " id="field_container_cf_tags">

</td>
    </tr>
    <tr>
      <th class="field_label " id="field_label_cf_bug_regression">


  <a title="If this bug is not a regression select no, otherwise select yes and complete the &quot;last known good build&quot; entry." class="field_help_link" href="#">Is this bug a regression?:</a>

</th>
  <td class="field_value " id="field_container_cf_bug_regression">---

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field" id="field_label_cf_bug_regression_build">


  <a title="What is the last known good build? (e.g. C7, 4.5.x, etc.)" class="field_help_link" href="#">Last known good build:</a>

</th>
  <td class="field_value  bz_hidden_field" id="field_container_cf_bug_regression_build">

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </tbody></table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </tbody></table>

  <table id="bz_big_form_parts">
  <tbody><tr>
  <td>

    


<br>
<table id="attachment_table">
  <tbody><tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6984&amp;file=FileStreamBug.rar" title="View the content of the attachment">
          <b>The app and data files that repeat the bug</b></a>

          <span class="bz_attach_extra_info">
              (61.08 KB,
                application/octet-stream)

            <br>
            <a href="#attach_6984" title="Go to the comment associated with the attachment">2014-06-04 19:54 UTC</a>,

            <span class="vcard"><span class="fn">Rowan</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6984&amp;file=FileStreamBug.rar">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6996&amp;file=FreezeLogB.txt" title="View the content of the attachment">
          <b>android log of the issue happening</b></a>

          <span class="bz_attach_extra_info">
              (1.28 MB,
                text/plain)

            <br>
            <a href="#attach_6996" title="Go to the comment associated with the attachment">2014-06-05 21:41 UTC</a>,

            <span class="vcard"><span class="fn">Rowan</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6996&amp;file=FreezeLogB.txt">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7229&amp;file=FileStreamBug2.rar" title="View the content of the attachment">
          <b>sample app that causes the issue faster than the previous app</b></a>

          <span class="bz_attach_extra_info">
              (54.12 KB,
                application/octet-stream)

            <br>
            <a href="#attach_7229" title="Go to the comment associated with the attachment">2014-06-29 00:41 UTC</a>,

            <span class="vcard"><span class="fn">Rowan</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7229&amp;file=FileStreamBug2.rar">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7258&amp;file=Spin%20on%20Suspend.rar" title="View the content of the attachment">
          <b>source code for the test app and the resulting log showing the error</b></a>

          <span class="bz_attach_extra_info">
              (33.13 KB,
                application/octet-stream)

            <br>
            <a href="#attach_7258" title="Go to the comment associated with the attachment">2014-07-01 22:30 UTC</a>,

            <span class="vcard"><span class="fn">Rowan</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7258&amp;file=Spin%20on%20Suspend.rar">Details</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7275&amp;file=TestApp.rar" title="View the content of the attachment">
          <b>test apps to repeat my observations</b></a>

          <span class="bz_attach_extra_info">
              (66.48 KB,
                application/octet-stream)

            <br>
            <a href="#attach_7275" title="Go to the comment associated with the attachment">2014-07-04 00:55 UTC</a>,

            <span class="vcard"><span class="fn">Rowan</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7275&amp;file=TestApp.rar">Details</a>
        </td>
      </tr>

  
</tbody></table>
<br>

  </td>
  <td>
  </td>
  </tr></tbody></table>
<hr>

<div id="add_comment" class="bz_section_additional_comments">
<div class="box" style="margin: 1px 1px 10px 1px; max-width: 47.8em">
    <p>
        <strong>Notice (2018-05-24)</strong>: bugzilla.xamarin.com is now in
        <strong>read-only</strong> mode.
    </p>
    <p>
        Please join us on
        <a href="https://developercommunity.visualstudio.com/spaces/8/index.html">
        Visual Studio Developer Community</a> and in the
        <a href="https://github.com/xamarin">Xamarin</a> and
        <a href="https://github.com/mono">Mono</a> organizations on
        GitHub to continue tracking issues. Bugzilla will remain
        available for reference in read-only mode. We will continue to work
        on <strong>open</strong> Bugzilla bugs, copy them to the new locations
        as needed for follow-up, and add the new items under <strong>Related
        Links</strong>.
    </p>
    <p>
        Our sincere thanks to everyone who has contributed on this bug
        tracker over the years. Thanks also for your understanding as we
        make these adjustments and improvements for the future.
    </p>
    <hr><p>
        <strong>Please create a new report</strong> on 
        <a href="https://docs.microsoft.com/visualstudio/ide/how-to-report-a-problem-with-visual-studio-2017">Developer Community</a> or <a href="https://github.com/xamarin">GitHub</a> with
        your current version information, steps to reproduce, and relevant error
        messages or log files if you are hitting an issue that looks similar to
        this resolved bug and you do not yet see a matching new report.
    </p>
</div>

    <div style="margin: 4ex 0">
        <table><tbody><tr><th class="field_label " id="field_label_see_also">


  <a title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields." class="field_help_link" href="#">Related Links:</a>

</th>
  <td class="field_value " id="field_container_see_also">

</td>
    </tr>
        </tbody></table>
    </div>

    <table id="bug_status_bottom" class="status">
        <tbody><tr>
            <th class="field_label">
                <a href="#">Status</a>:
            </th>
            <td><div id="status">RESOLVED

    <noscript><br>resolved as </noscript>

  <span id="resolution_settings">FIXED
  </span>

</div>


            </td>
        </tr>
    </tbody></table>

</div>
    <hr>

  
  <div id="comments">




<!-- This auto-sizes the comments and positions the collapse/expand links
     to the right. -->
<table class="bz_comment_table">
<tbody><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-04 19:54:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=6984&amp;file=FileStreamBug.rar" name="attach_6984" title="The app and data files that repeat the bug">attachment 6984</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6984&amp;file=FileStreamBug.rar" title="The app and data files that repeat the bug">[details]</a></span>
The app and data files that repeat the bug

If a FileStream is read over and over on a thread that is not the UI thread after about an hour the app hangs with no exception, just both the main UI thread and the extra thread doing the FileStream read are no longer running and if debugging and your press pause nothing happens.

If I move the FileStream read code to the main UI thread then it never hangs.

I have included the very simple app that repeats the issue (As there was no feedback in the log or from the app the only way I was able to debug this is was to start from my app of 60,000 lines of code and cut code out while the issue was still happening until I was left with 30 lines of code...) It has been a very painful week.

I also included the files that are being read in the folder Dados.rar

I have had this bug repeat on all 4 of my different android devices.</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 08:31:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">I found a work around for this bug, if I use FileInputStream it does not hang,
however their still is another similar hang in my app still. Is their any way
to get some diagnostics suggestions for finding the cause as I don't really
want to spend another week dividing the 60,000 lines down to 30 lines of code
again. I would say it is something similar to this bug as the result is exactly
the same, just freeze the app with no diagnostics information.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Udham Singh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 09:22:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">I have checked this issue at my end, but I am not able to reproduce this issue.
I have gone through following steps :

1. I downloaded the attached project and launch it on device.
2. I added the breakpoint in ThreadWork() method.
3. Then I debug the application, Then I press the paused. As expected, It
paused the application.
4. Then I let the application run for more than 1 hour and observed that It did
not hang.
5. Then again I followed the step 3.

Screencast : <a href="http://www.screencast.com/t/VLnWVJsKBD">http://www.screencast.com/t/VLnWVJsKBD</a>
Output Log : <a href="https://gist.github.com/saurabh360/34a092b1d40ed7d795d5">https://gist.github.com/saurabh360/34a092b1d40ed7d795d5</a>

Please let me know if I have missed some steps to reproduce this issue.

Environment Info :

Microsoft Visual Studio Professional 2013
Version 12.0.30501.00 Update 2
Microsoft .NET Framework
Version 4.5.51641

Xamarin   3.0.54.0 (d3cf238e3845e930e312b6ec9b4c6c5437c33067)
Visual Studio extension to enable development for Xamarin.iOS and
Xamarin.Android

Xamarin.Android   4.12.4.20 (b5dc5ce91305e19de51d71a1122c109719c4bc34)
Visual Studio plugin to enable development for Xamarin.Android.

Xamarin.iOS   3.0.54.0 (d3cf238e3845e930e312b6ec9b4c6c5437c33067)
Visual Studio extension to enable development for Xamarin.iOS</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 19:25:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">In step 1 did you extract the folder from the Dados.rar file and place it on the SD card? So that the path matches "/sdcard/5500/Dados/Talhoes/"  The rar file only has the Talhoes folder inside so either create the 5500 and Dados folders yourself or modify the path in the app to remove those folders.

If the mount path of the sdcard on your device does not match the path I hard coded then please change it. Set a breakpoint and check that it is finding the files and reading the files.

Regarding the pause it only doesn't respond if the app has frozen. Up until then it will pause fine, just when the screen stops flashing blue and you try and pause the app to find the state of the program nothing happens.

Also the hour timeline is not always accurate, it can be 20 minutes and it can take 3 hours. But the average I estimate is 1 hour.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 19:41:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">Sorry I just watched the screencast you did and you already did modify the path.

I will modify the app a little bit to output some data in the android log to help check that things are going as expected, and I will append my log file for you to compare against.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 21:38:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok to make it simpler you don't need the extra folder, I just create a file on the sd card in the app, then read that back.

Just replace the function ThreadWork with the new function, I have uploaded 2 logs of the issue, as you can see the log just stops with nothing unusual shown.

 protected void ThreadWork()
        {
            const string path = "/sdcard/temp.txt";
            var fSTmp = new FileStream(path, FileMode.OpenOrCreate, FileAccess.Write);
            fSTmp.Write(new byte[100000], 0, 100000);
            fSTmp.Close();
            long bytesRead = 0;
            int lastLog = System.Environment.TickCount;
            while (true)
            {
                if (System.Environment.TickCount &gt; lastLog + 5000)
                {
                    lastLog = System.Environment.TickCount;
                    Android.Util.Log.Info("BytesRead", bytesRead.ToString());

                }

                var fS = new FileStream(path, FileMode.Open, FileAccess.Read);
                bytesRead += fS.Length;
                fS.Read(new byte[fS.Length], 0, (int)fS.Length);
                fS.Close();
                fS.Dispose();
            }
        }</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-05 21:41:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=6996&amp;file=FreezeLogB.txt" name="attach_6996" title="android log of the issue happening">attachment 6996</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=6996&amp;file=FreezeLogB.txt" title="android log of the issue happening">[details]</a></span>
android log of the issue happening</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-10 20:23:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Were you able to reproduce this?

Anything I can do to help let me know because the problem is very serious.

My environment info matches yours, (except that I use visual studio 2012, but I tested this and the same thing happens with xamarin studio.</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tajinder Singh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-11 09:27:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks Rowan

I have checked this issue with the code provided in <a href="bug.html">comment 5</a> and I am still observing the same behavior as mentioned in <a href="bug.html">comment 2</a>.

Herewith I have attached output log:

For VS 2012 : <a href="https://gist.github.com/saurabh360/6516cbd0d844e942520e">https://gist.github.com/saurabh360/6516cbd0d844e942520e</a>
For VS 2013 : <a href="https://gist.github.com/saurabh360/67febe0c7232e9e1ac6f">https://gist.github.com/saurabh360/67febe0c7232e9e1ac6f</a>

We may have to see if a developer can figure out what's going on from the output log.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-16 04:54:36 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok I have tried this with 2 additional machines compiling the code with the same environment as mentioned above. They both repeated this error, however it seems the first time the issue happens it can take a long time to happen. I noticed if the device was reset it would take anywhere from 4 hours to 56 hours for the problem to happen.

But if the problem has occurred and you don't reset the device and run the app again then it will happen much faster, usually around 1 hour.

I was never turning off my devices so I was always seeing it happen at the shorter time interval.

Unfortunately to repeat this you will need to run the app for an extended period of time for the first time.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jonathan Pryor</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-20 23:40:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">@Rowan: Do you still see the problem if you use System.Threading.Thread instead of Java.Lang.Thread? (Not sure why that would matter, but worth testing...)</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-21 00:49:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">yeah I already thought of that and gave it a try but had the same result unfortunately</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-22 03:53:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">There is a similar bug that I posted that is easier to repeat that shows similar behaviour so may be related to this one, it may be unrelated but worth taking a look. <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed" title="RESOLVED FIXED - ConcurrentQueue causes the app to halt and mono to stop responding" href="https://bugzilla.xamarin.com/show_bug.cgi?id=20794">https://bugzilla.xamarin.com/show_bug.cgi?id=20794</a></pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-29 00:38:25 UTC
        </span>

      </div>




<pre class="bz_comment_text">I have modified the app to make this more repeatable, if I just create more threads to do the same task just have 4 threads doing this task at the same time it brings the freeze much quicker, anywhere from 5 minutes to 20 minutes. Again after it happens the first time it seems to happen much faster the second time, so don't reboot the device after the first time.

I have attached the modified sample app "FileStreamBug2.rar". I also added some extra debug strings output to the log.

I added a check for threads being paused (as I could see the screen stop updating briefly) On each thread if there is a delay of more than 100ms on any of the work threads or the render thread then it will output a message to the log.

From this I have seen that the render thread is the one that is being delayed periodically. Usually 130ms to 150ms delays are being written to the log. But none of the work threads are having delays. I experienced the same behaviour for 1 work thread or for 4 work threads, the render thread was still having these large delays for no reason.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-29 00:41:28 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=7229&amp;file=FileStreamBug2.rar" name="attach_7229" title="sample app that causes the issue faster than the previous app">attachment 7229</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7229&amp;file=FileStreamBug2.rar" title="sample app that causes the issue faster than the previous app">[details]</a></span>
sample app that causes the issue faster than the previous app

just uses 4 work threads instead of 1.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-30 07:12:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Rowan, a suggestion similar to made by Jon in <a href="bug.html">comment 10</a> - have you tried using either a threadpool or System.Threading.Tasks? If you didn't, can you try if they help? I'm currently running the application waiting for the deadlock to happen. It's been running for 10 minutes so far without any problems.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-30 08:26:08 UTC
        </span>

      </div>




<pre class="bz_comment_text">I just tried both thread pool and task and I have had crashes with both approaches  within a few minutes.

What device are you using, is it quad core?

I have the issue happening on Galaxy S2, Galaxy Note 2, Nexus 5, a Freescale IMX6 custom device, rockchip hdmi device.

With varying android versions from 4.1.2 to 4.4.2

I have not had a device not repeat this issue.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-06-30 08:30:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">I was able to eventually reproduce it. I'm using Nexus 10 and Nexus 5, so yes, quad cores. Both of my nexuses are running android 4.4.4.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-01 09:40:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">Rowan, while I don't have a fix since I'm not even able to get a thread dump from the application running on device once it locks up (gdb locks up as well, go figure) I have managed to make the sample you supplied to run without locking up.

The change I made is related to the memory usage. Inside the while loop in ThreadWork you allocate a 100k byte buffer on each iteration. Creating a buffer variable and allocating the memory only when the buffer is null or too small made a world of difference. Before the change I got the lock up within 2-3 minutes on my Nexus 10, it's been running for 40 minutes now without a hitch. Looking at the log you provided in <a href="bug.html">comment 6</a> I now lean towards explanation that the memory allocation puts too much pressure on the operating system memory and both the OS and dalvik end up deciding that the app is too aggressive with its memory usage and stop it. I don't have a confirmation for this, except for my modification which makes the dalvik GC messages disappear from the log completely. At the same time I'm running the test with Mono's GC logging enabled and I don't see anything out of ordinary in the output.

I don't know how closely the sample you provided reflects what's happening in your application but I'd suggest implementing a simple memory pool to provide buffers for the file reads. Also, I'd recommend not creating an instance of FileStream in each iteration (it's very expensive to set up) but reuse the stream as much as possible by seeking. If you keep reading a single file which is growing, it's easy to read the file state to obtain its size and read just the data that was added since last read. Alternatively, you can use FileSystemWatcher to observe the file(s) for changes and read only when a change is signalled.

Please let me know if memory pooling helps your application.</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-01 22:28:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">This case does not accurately reflect my app, my app is very complex, however this was one case I was able to isolate that the environment just stops responding. So I am not looking to stop this one case happening, I am looking to find the reason it stops happening. Switching to Java.IO.FileInputStream seems to reduce occurrence of this 1 case. But it is still happening.

The question is if too much memory allocation per second was the reason, then why would just switching to Java.IO.FileInputStream instead of FileStream stop this from happening? It is still allocating a similar amount of memory.

And why would the OS not kill the app completely, when the OS runs out of memory it kills the process completely and puts this in the android log. This is just freezing the app with nothing put in the log.

I just had a stack trace output for once on a crash!! It is not the exact same application, it is using thread pool. (And creating a new thread each time instead of a while loop. Which was still just crashing the same way, then I was testing Java.IO.FileInputStream which was crashing much less but on one occasion it sent out some info!! I have attached the file "spin on suspend.rar" that has the source code and the output.

You can see that the GC can not stop one of the threads for some reason. What could cause that to happen? 

This sounds very familiar to something else I have seen in my real app. There was a period of almost 2 second in my app where all threads where halted for no reason. The log did not say that the garbage collection took a long time, only 20 or 30ms was reported. But all threads were halted for almost 2 seconds. So it seems like the GC is trying to stop the threads so it can run but some thread is not halting as it should. It could be a separate issue of something else causing all threads to stop for 2 seconds but it does sound similar. Sometimes the thread does eventually halt.</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-01 22:30:12 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=7258&amp;file=Spin%20on%20Suspend.rar" name="attach_7258" title="source code for the test app and the resulting log showing the error">attachment 7258</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7258&amp;file=Spin%20on%20Suspend.rar" title="source code for the test app and the resulting log showing the error">[details]</a></span>
source code for the test app and the resulting log showing the error</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-02 23:37:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok here is the next weird test.

I created a test app in Java (no openGl) to test your theory of memory allocation being the issue, the app is not crashing doing the same thread work. Which goes against that theory as it is running faster if anything and allocating/freeing more bytes per second.

So I did the same thing in mono, a basic activity app with no opentk, and it also is not crashing also.

So from my original opentk app I removed all my code for doing threads and commented commented out the onrender function. So the app was the minimum app for opentk, and in the log the GREFs were still increasing like crazy and the garbage collector was being called every 6 seconds! The GREF's in the log were always increasing like crazy.

So it is pointing to something wrong with opentk. The memory allocation just seems to bring on the issue, like opentk has corrupted the memory and as the app is always requesting new memory it gets passed memory it should not have.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-03 02:37:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Rowan, thanks for the update! It's a good clue for the direction we can look in. On my part, I was digging in the Mono runtime and the GC and it seems that what's happening is some external trigger (I still think it's the OOM) which causes ALL of the process threads to enter sleep state (deep in the kerenel, in this case in sys_sigsuspend). I'm still trying to figure out what the external factor might be as well as keep looking for other causes in the runtime.</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-03 19:53:19 UTC
        </span>

      </div>




<pre class="bz_comment_text">to see if it was opentk I made the same test but with native Android.Opengl
It also caused the problem (not as often taking longer for it to happen) but sometimes with different symptoms, sometimes it killed the device, turned it straight off...

The version with no opengl has been running on multiple devices and still has not crashed yet.</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-04 00:55:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=7275&amp;file=TestApp.rar" name="attach_7275" title="test apps to repeat my observations">attachment 7275</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=7275&amp;file=TestApp.rar" title="test apps to repeat my observations">[details]</a></span>
test apps to repeat my observations

I have some more results, I created a java opengl app, identical to the mono native opengl app.

I increased the file size by 5 times to further test the memory theory.

The java app is yet to fail after 6 hours so far, the mono app has failed 3 times in that same period. The garbage collector is going crazy due to all the allocations but it is not failing in java and in mono it is failing and sometimes killing the OS also.

I have attached the apps if you want to look closer at my results and tests. (as well as the other apps from the comments above)

I also included the file to use for the tests so the same file is used each time. Just put that file on the /sdcard/ directory</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-04 02:13:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">Rowan, thanks for the tests! It's definitely something with the GCs (either the interaction of them or one side is misbehaving) and I'm still in the process of looking for the cause.</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rowan</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-04 02:26:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">ok great! 

One extra bit of info, I just had the non opengl mono app crash. (the one that is in the sample apps from <a href="bug.html">comment 24</a>)

I had added one extra piece of code to that app, when I tested it all yesterday and it did not crash their was no updating of the screen so I was not asking the main UI thread to do anything. Which in all the other apps the main UI thread is being called all the time to update the screen. So I added a thread that causes the activity to refresh the view every 30ms (the same rate as the opengl apps) And this caused the crash to happen.

So it is nothing to do with the opengl librarys themselves, but some interaction of the main ui thread.

Good luck with the hunt!</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-04 02:32:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Yeah, there's something happening that triggers some external response which, in effect, halts the process. The interesting thing is that the OS does *not* consider the app dead. The screen updates find is a good hint. There might be an awful lot going on behind the scenes when the screen is updated in opengl context. Currently, however, I'm really focused on finding where and how the process is suspended in the GC. Once I know that I can move to looking at the other areas :)</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marek Habersack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-07-10 06:59:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">This bug was fixed by <a href="https://github.com/mono/mono/commit/afa4cebee3d00dbb198880ffcc4cf0f8f237a23b">https://github.com/mono/mono/commit/afa4cebee3d00dbb198880ffcc4cf0f8f237a23b</a>

Note that the fix is *not* present in any Xamarin.Android release as of this moment.</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Frederic Rudman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-08-20 10:20:28 UTC
        </span>

      </div>




<pre class="bz_comment_text">We are experiencing something very close (but not exactly the same) as the problem listed above. The symptoms are described below but first, a quick question: it's now August 20th, 2014: has the fix above been released to Android/IDE yet or not. If it has, our problem is NOT solved. If not, I'm hoping maybe your fix will work for us. This is a serious/major/show-stopper problem for us.



[IMPORTANT: as per the last statement below: If it has been fixed but not yet released, is there a way for us to test your fix right away? Please let us know. Thanks.]



Our environment: An Android-based UDOO Quad (Android running on the Freescale i.MX6 side; Arduino running on an Atmel SAM3x mcu). We're trying to use the Arduino connected to Android as per Android's ADK/USB Accessory.

Steps to reproduce are consistent (sadly): we simply get the USBManager (as per Android docs/protocol), open the FileInputStream from the Accessory's FileDescriptor (a Java object) and start reading that fileInputStream. [on the Arduino side, we use USBHost/ADK, also as per protocol]

For the tests, we kept everything simple: we simply periodically write a few bytes on the Arduino side to be read on the Android side. Reading is done a Thread (.net) and upon reception of bytes we update the UI (via RunOnUIThread calls, obviously). All threading/reading is done on the .Net side, in a simple loop with NO dynamic object allocations: we use a once-allocated byte buffer over-and-over, 1024 bytes.

All is well for a while: we've had anywhere from 12,000 reads all the way up to 30,000 reads depending on how we varied the delay on the Arduino's side (a simple write functions that writes M bytes consistently to the USB Accessory every N milliseconds: we tested N with 50ms, 300ms, 330ms, 400ms, and 500ms, and matrix tested with M at 9 bytes, 14 bytes, and 26 bytes.

Although the failure rates were sometimes different we've ALWAYS failed in the fileInputStream.read after anywhere from 12,000 reads (a few minutes at 50ms) to 30,000 reads (a few hours at 500ms).

All these reads are done on a simple separate .Net THREAD (not Java) and it was never a hang (unlike the symtoms described by you above): we always end up with a caught Java.IO exception (caught from the .net try/catch side): most often (99%, but not 100%) it's a "No Such Device/ENODEV" error (as if the "device" disappeared suddenly" [at libcore.io.IoBridge.read (IoBridge.java: 435; FileInputStream.java: 179]). We can supply all the test code, if needed/wanted, to consistently reproduce this problem.

When the reads succeeded (up until the end) the bytes read were always correct (not a single error).

We've also tested it with regular and, separately, occasional writes (using FileOutputStream) in case we needed to perhaps "prime/refresh the pump/pipeline" both ways. No go.

We've also tested with regularly CLOSING, then REOPENING the file streams (both input and output) after a fixed number of messages (e.g. 1,000) as a "soft reset" feature. That definitely improved the number of loops (from our early 3K-5K to 12K-30K) but still failed in the end.

We suspected all along that it was a memory/GC problem but when we list available RAM (using Android's MemoryInfo) it shows plenty of memory and very little used (our code does NOT do dynamic allocations).

We need to be able to have our Arduino hardware communicate "continuously" over the USB Accessory port for MONTHS on end, not just a few minutes or hours. We can probably reduce the frequency of writes from 50ms to maybe 500ms [that would be slow but we could adjust for that] in case speed is an issue for the USB Accessory link, but it needs to be either:
1) consistent and never fail) 
...OR...
2) If it must fail, we need to be able to reset/restart it in software (we can/could [probably] afford a few seconds/minute of no comm while that link is being reset).

Does any of this seem familiar to you folks or should I file this as a separate bug?

Would there be any workaround in the meantime: this bug is a major show-stopper for us. The biggest problem is that when the communication between Arduino and Android dies, we have no way to restart it: Android cannot be software-tricked into Resetting the USB Accessory (unless you know something we don't?)

IMPORTANT: If this is likely the same problem you fixed but it has been fixed but not yet released, is there a way for us to test your fix right away? Please let us know. Thanks.</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Frederic Rudman</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-08-20 10:22:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">[as a hint in case it helps, this is the environment we use:

=== Xamarin Studio ===

Version 5.2.1 (build 1)
Installation UUID: 75a1b04b-0573-48dd-9033-bf08bc7f5047
Runtime:
	Microsoft .NET 4.0.30319.18444
	GTK+ 2.24.22 (MS-Windows theme)
	GTK# 2.12.25

=== Xamarin.Android ===

Version: 4.14.0 (Indie Edition)
Android SDK: C:\Users\DV18Admin\AppData\Local\Android\android-sdk
	Supported Android versions:
		2.1   (API level 7)
		2.2   (API level 8)
		2.3   (API level 10)
		3.1   (API level 12)
		4.0   (API level 14)
		4.0.3 (API level 15)
		4.2   (API level 17)
		4.3   (API level 18)
		4.4   (API level 19)
Java SDK: C:\Program Files (x86)\Java\jdk1.6.0_39
java version "1.6.0_39"
Java(TM) SE Runtime Environment (build 1.6.0_39-b04)
Java HotSpot(TM) Client VM (build 20.14-b01, mixed mode, sharing)

=== Build Information ===

Release ID: 502010001
Git revision: d06832ce9807d6be24aca225457e8b37c7669f6f
Build date: 2014-08-07 14:35:09-04
Xamarin addins: 1de032531be4cecf2f39dbee3b87aac78204058c

=== Operating System ===

Windows 6.1.7601.65536 (64-bit)</pre>
    </div>




</td>
<td>
</td>
</tr></tbody></table>
  </div>


</form>

<hr>


<br>
</div>

    

  
</body></html>
