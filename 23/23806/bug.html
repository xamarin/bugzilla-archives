<html lang="en"><head>
    <title>23806 – HttpWebRequest fails after wifi change</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style>/* js/yui/assets/skins/sam/autocomplete.css */
.yui-skin-sam .yui-ac{position:relative;font-family:arial;font-size:100%}.yui-skin-sam .yui-ac-input{position:absolute;width:100%}.yui-skin-sam .yui-ac-container{position:absolute;top:1.6em;width:100%}.yui-skin-sam .yui-ac-content{position:absolute;width:100%;border:1px solid #808080;background:#fff;overflow:hidden;z-index:9050}.yui-skin-sam .yui-ac-shadow{position:absolute;margin:.3em;width:100%;background:#000;-moz-opacity:.10;opacity:.10;filter:alpha(opacity=10);z-index:9049}.yui-skin-sam .yui-ac iframe{opacity:0;filter:alpha(opacity=0);padding-right:.3em;padding-bottom:.3em}.yui-skin-sam .yui-ac-content ul{margin:0;padding:0;width:100%}.yui-skin-sam .yui-ac-content li{margin:0;padding:2px 5px;cursor:default;white-space:nowrap;list-style:none;zoom:1}.yui-skin-sam .yui-ac-content li.yui-ac-prehighlight{background:#b3d4ff}.yui-skin-sam .yui-ac-content li.yui-ac-highlight{background:#426fd9;color:#FFF}
/* js/yui/assets/skins/sam/calendar.css */
.yui-calcontainer{position:relative;float:left;_overflow:hidden}.yui-calcontainer iframe{position:absolute;border:0;margin:0;padding:0;z-index:0;width:100%;height:100%;left:0;top:0}.yui-calcontainer iframe.fixedsize{width:50em;height:50em;top:-1px;left:-1px}.yui-calcontainer.multi .groupcal{z-index:1;float:left;position:relative}.yui-calcontainer .title{position:relative;z-index:1}.yui-calcontainer .close-icon{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar{position:relative}.yui-calendar .calnavleft{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar .calnavright{position:absolute;z-index:1;text-indent:-10000em;overflow:hidden}.yui-calendar .calheader{position:relative;width:100%;text-align:center}.yui-calcontainer .yui-cal-nav-mask{position:absolute;z-index:2;margin:0;padding:0;width:100%;height:100%;_width:0;_height:0;left:0;top:0;display:none}.yui-calcontainer .yui-cal-nav{position:absolute;z-index:3;top:0;display:none}.yui-calcontainer .yui-cal-nav .yui-cal-nav-btn{display:-moz-inline-box;display:inline-block}.yui-calcontainer .yui-cal-nav .yui-cal-nav-btn button{display:block;*display:inline-block;*overflow:visible;border:0;background-color:transparent;cursor:pointer}.yui-calendar .calbody a:hover{background:inherit}p#clear{clear:left;padding-top:10px}.yui-skin-sam .yui-calcontainer{background-color:#f2f2f2;border:1px solid #808080;padding:10px}.yui-skin-sam .yui-calcontainer.multi{padding:0 5px 0 5px}.yui-skin-sam .yui-calcontainer.multi .groupcal{background-color:transparent;border:0;padding:10px 5px 10px 5px;margin:0}.yui-skin-sam .yui-calcontainer .title{background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;border-bottom:1px solid #ccc;font:100% sans-serif;color:#000;font-weight:bold;height:auto;padding:.4em;margin:0 -10px 10px -10px;top:0;left:0;text-align:left}.yui-skin-sam .yui-calcontainer.multi .title{margin:0 -5px 0 -5px}.yui-skin-sam .yui-calcontainer.withtitle{padding-top:0}.yui-skin-sam .yui-calcontainer .calclose{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -300px;width:25px;height:15px;top:.4em;right:.4em;cursor:pointer}.yui-skin-sam .yui-calendar{border-spacing:0;border-collapse:collapse;font:100% sans-serif;text-align:center;margin:0}.yui-skin-sam .yui-calendar .calhead{background:transparent;border:0;vertical-align:middle;padding:0}.yui-skin-sam .yui-calendar .calheader{background:transparent;font-weight:bold;padding:0 0 .6em 0;text-align:center}.yui-skin-sam .yui-calendar .calheader img{border:0}.yui-skin-sam .yui-calendar .calnavleft{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -450px;width:25px;height:15px;top:0;bottom:0;left:-10px;margin-left:.4em;cursor:pointer}.yui-skin-sam .yui-calendar .calnavright{background:url(../../js/yui/assets/skins/sam/sprite.png) no-repeat 0 -500px;width:25px;height:15px;top:0;bottom:0;right:-10px;margin-right:.4em;cursor:pointer}.yui-skin-sam .yui-calendar .calweekdayrow{height:2em}.yui-skin-sam .yui-calendar .calweekdayrow th{padding:0;border:0}.yui-skin-sam .yui-calendar .calweekdaycell{color:#000;font-weight:bold;text-align:center;width:2em}.yui-skin-sam .yui-calendar .calfoot{background-color:#f2f2f2}.yui-skin-sam .yui-calendar .calrowhead,.yui-skin-sam .yui-calendar .calrowfoot{color:#a6a6a6;font-size:85%;font-style:normal;font-weight:normal;border:0}.yui-skin-sam .yui-calendar .calrowhead{text-align:right;padding:0 2px 0 0}.yui-skin-sam .yui-calendar .calrowfoot{text-align:left;padding:0 0 0 2px}.yui-skin-sam .yui-calendar td.calcell{border:1px solid #ccc;background:#fff;padding:1px;height:1.6em;line-height:1.6em;text-align:center;white-space:nowrap}.yui-skin-sam .yui-calendar td.calcell a{color:#06c;display:block;height:100%;text-decoration:none}.yui-skin-sam .yui-calendar td.calcell.today{background-color:#000}.yui-skin-sam .yui-calendar td.calcell.today a{background-color:#fff}.yui-skin-sam .yui-calendar td.calcell.oom{background-color:#ccc;color:#a6a6a6;cursor:default}.yui-skin-sam .yui-calendar td.calcell.oom a{color:#a6a6a6}.yui-skin-sam .yui-calendar td.calcell.selected{background-color:#fff;color:#000}.yui-skin-sam .yui-calendar td.calcell.selected a{background-color:#b3d4ff;color:#000}.yui-skin-sam .yui-calendar td.calcell.calcellhover{background-color:#426fd9;color:#fff;cursor:pointer}.yui-skin-sam .yui-calendar td.calcell.calcellhover a{background-color:#426fd9;color:#fff}.yui-skin-sam .yui-calendar td.calcell.previous{color:#e0e0e0}.yui-skin-sam .yui-calendar td.calcell.restricted{text-decoration:line-through}.yui-skin-sam .yui-calendar td.calcell.highlight1{background-color:#cf9}.yui-skin-sam .yui-calendar td.calcell.highlight2{background-color:#9cf}.yui-skin-sam .yui-calendar td.calcell.highlight3{background-color:#fcc}.yui-skin-sam .yui-calendar td.calcell.highlight4{background-color:#cf9}.yui-skin-sam .yui-calendar a.calnav{border:1px solid #f2f2f2;padding:0 4px;text-decoration:none;color:#000;zoom:1}.yui-skin-sam .yui-calendar a.calnav:hover{background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;border-color:#a0a0a0;cursor:pointer}.yui-skin-sam .yui-calcontainer .yui-cal-nav-mask{background-color:#000;opacity:.25;filter:alpha(opacity=25)}.yui-skin-sam .yui-calcontainer .yui-cal-nav{font-family:arial,helvetica,clean,sans-serif;font-size:93%;border:1px solid #808080;left:50%;margin-left:-7em;width:14em;padding:0;top:2.5em;background-color:#f2f2f2}.yui-skin-sam .yui-calcontainer.withtitle .yui-cal-nav{top:4.5em}.yui-skin-sam .yui-calcontainer.multi .yui-cal-nav{width:16em;margin-left:-8em}.yui-skin-sam .yui-calcontainer .yui-cal-nav-y,.yui-skin-sam .yui-calcontainer .yui-cal-nav-m,.yui-skin-sam .yui-calcontainer .yui-cal-nav-b{padding:5px 10px 5px 10px}.yui-skin-sam .yui-calcontainer .yui-cal-nav-b{text-align:center}.yui-skin-sam .yui-calcontainer .yui-cal-nav-e{margin-top:5px;padding:5px;background-color:#edf5ff;border-top:1px solid black;display:none}.yui-skin-sam .yui-calcontainer .yui-cal-nav label{display:block;font-weight:bold}.yui-skin-sam .yui-calcontainer .yui-cal-nav-mc{width:100%;_width:auto}.yui-skin-sam .yui-calcontainer .yui-cal-nav-y input.yui-invalid{background-color:#ffee69;border:1px solid #000}.yui-skin-sam .yui-calcontainer .yui-cal-nav-yc{width:4em}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn{border:1px solid #808080;background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 0;background-color:#ccc;margin:auto .15em}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn button{padding:0 8px;font-size:93%;line-height:2;*line-height:1.7;min-height:2em;*min-height:auto;color:#000}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn.yui-default{border:1px solid #304369;background-color:#426fd9;background:url(../../js/yui/assets/skins/sam/sprite.png) repeat-x 0 -1400px}.yui-skin-sam .yui-calcontainer .yui-cal-nav .yui-cal-nav-btn.yui-default button{color:#fff}
/* skins/standard/global.css */
body {font-family: sans-serif;color: #000;background: #fff url(../../skins/standard/global/body-back.gif) repeat-x;}body, td, th, input, dt, #titles {font-family: Verdana, sans-serif;font-size: small;}pre, code, kbd {font-size: medium;}#bugzilla-body {clear: both;}#bugzilla-body th {font-weight: bold;vertical-align: top;}#header {margin-bottom: 1em;}#header form, #header form input,#footer form, #footer form input{font-size: 95%;display: inline;}#header .links {border-left: 1px solid #747E93;border-right: 1px solid #747E93;border-bottom: 1px solid #747E93;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;padding: 0.5em;}#lang_links_container {float: right;white-space: nowrap;}#lang_links_container .links {border: none;padding: .5em;}.lang_current {font-weight: bold;}#message {border: 1px solid red;margin: 0.3em 0em;padding: 0.3em;color: green;}form.mini_login input.bz_login  {width: 10em;}form.mini_login input.bz_password {width: 6em;}form.mini_login input.bz_remember {margin: 0;}#banner {}#titles {width: 100%;background-color: #404D6C;color: #fff;border-top-left-radius: 5px;border-top-right-radius: 5px;margin: 0;vertical-align: bottom;display: table;}#titles a {color: #fff;}#titles p {margin: 0;padding: 0;}#titles #title {font-weight: bold;padding: 0.5em;white-space: nowrap;display: table-cell;}#titles #subtitle {font-weight: normal;text-align: center;padding: 0.5em;display: table-cell;}#titles #information {font-weight: normal;text-align: right;font-size: 90%;padding: 0.5em;white-space: nowrap;display: table-cell;}#footer {clear: both;margin-top: 1em;width: 100%;background: #edf2f2;border-top: 1px solid #ddd;border-bottom: 1px solid #ddd;}#footer #useful-links {padding-left: 1ex;padding-right: 1ex;}#footer ul {list-style-type: none;}#links-saved ul {display: inline;}#links-saved th {vertical-align: top;}#footer .label {white-space: nowrap;vertical-align: top;}#footer .links {vertical-align: top;}ul.links {margin: 0;padding: 0;list-style-type: none;}ul.links li {display: inline;white-space: nowrap;}table.tabs {width: 100%;}.tabs th, .tabs td {padding: 1em;}.tabs td {background: #eee;text-align: center;border-style: solid;border-color: black;border-width: 0px 0px 2px 0px;}.tabs td.selected {background: white;border-width: 2px 2px 0px 2px;}.tabs td.spacer {background: white;}a {color: #039;}a:visited {color: #636;}a:hover {color: #333;}a:active {color: #000;}.clickable_area {cursor: pointer;}textarea {font-family: monospace;}a.controller {font-size: 115%;}div#docslinks {float: right;border: 1px solid black;padding: 1ex;font-size: 80%;}#docslinks h2 {margin: 0;}.rss {background: transparent url(../../skins/standard/../../images/rss_small.png) no-repeat;padding-left: 16px;line-height: 1.5em;}.bz_bug_link {}.bz_bug_link.bz_status_UNCONFIRMED {font-style: italic;}.bz_obsolete {text-decoration: line-through;}.bz_inactive {text-decoration: line-through;}.bz_closed,.bz_CLOSED td {text-decoration: line-through;}.bz_private {color: darkred;background: #f3eeee;}.bz_disabled {color: #a0a0a0;}.bz_comment_table td {vertical-align: top;}.bz_comment {margin-bottom: 2em;}.bz_comment_text, .uneditable_textarea, tbody.file pre {font-family: monospace;white-space: pre-wrap;}.bz_comment_text {width: 50em;}.bz_comment_text span.quote {color: #65379c;white-space: pre;overflow: auto;display: block;}.bz_comment_user, .bz_comment_time, .bz_comment_number,.bz_private_checkbox, .bz_comment_actions{margin: 0 .5em;}.bz_comment_actions, .bz_comment_number, .bz_private_checkbox {float: right;}.bz_collapse_expand_comments {padding: 0;margin: 0 0 0 1em;list-style-type: none;}.bz_collapse_expand_comments li {margin-bottom: .5em;}.bz_collapse_comment {text-decoration: none;}.bz_private_checkbox input {margin: 0;vertical-align: middle;}.bz_comment_head, .bz_first_comment_head {padding-top: .1em;padding-bottom: .1em;padding-left: .5em;background-color: #e0e0e0;}.bz_comment_user_images img {vertical-align: bottom;}.bz_comment_hilite pre {background-color: lightgreen;margin: 0;padding: 1em 0;}.bz_comment_collapse_reason,.bz_default_collapsed .bz_comment_number {font-weight: normal;}.bz_default_hidden, .bz_tui_hidden, .bz_hidden_field, .bz_hidden_option {display: none !important;}table#flags th,table#flags td {vertical-align: middle;text-align: left;}#email_prefs, #saved_search_prefs, #shared_search_prefs,#bug_activity {border: 1px solid black;border-collapse: collapse;}#email_prefs th,#shared_search_prefs th,#saved_search_prefs th {text-align: center;}#email_prefs th, #email_prefs td,#shared_search_prefs th, #shared_search_prefs td,#saved_search_prefs th, #saved_search_prefs td,#bug_activity td {border: 1px solid;padding: 0.3em;}#email_prefs th.role_header {width: 10%;}#bug_activity td {vertical-align: top;}#user_prefs th, #user_prefs td {padding: 0.5em;}#permissions {margin-left: auto;margin-right: auto;width: 40em;}#permissions p {margin-top: 2em;margin-bottom: 0.5em;}#permissions li {list-style-type: none;}#permissions table td {vertical-align: top;}.column_header {background-color: #66f;}.column_header th {text-align: center;}.flag_select {min-width: 3em;}input.requestee {width: 15em;}#error_msg {font-size: x-large;}#post_err_msg, form#check {clear: both;}.warning {color: red;}.throw_error {background-color: red;color: black;font-size: 120%;margin-bottom: 2em;padding: 0.5em 1em;float: left;}.label {font-weight: bold;}.throw_error a:visited {color: darkblue ;}dt {font-weight: bold;}body > dl > dt {border-top: dotted gray thin;}dl dl > dt {border-top: none;}.arrow_button {font-size: 150%;}#attachment_table {border-collapse: collapse;border: 1px solid #333333;}#attachment_table th, .bz_attach_footer, .bz_time_tracking_table th,.dependency_tree_controls {background-color: #E0E0E0;color: black;}#attachment_table td, .bz_time_tracking_table th, .bz_time_tracking_table td {border: 1px solid #333333;}#attachment_table th, #attachment_table td {padding: 0.3em;}.bz_attach_extra_info, .bz_info {font-size: smaller;}.bz_attach_flags, .bz_attach_footer, .bz_flags, .nowrap {white-space: nowrap;}.bz_attach_view_hide {float: right;padding-left: 1em;}#user_match_table {border-collapse: collapse;}#user_match_table td {vertical-align: top;border-bottom: 1px solid black;padding: 1em 0.5em;}div.user_match {margin-bottom: 1em;}.indented {margin-left: 3em;}.box {border: 1px solid black;color: black;background-color: #ffc;margin: 1em;padding: 0.5em 1em;}.collapsed,.bz_default_collapsed .bz_private_checkbox,.bz_default_collapsed .bz_comment_user,.bz_default_collapsed .bz_comment_user_images,.bz_default_collapsed .bz_comment_time,.bz_default_collapsed .bz_comment_tags,.bz_default_collapsed .bz_comment_text,.bz_default_collapsed .bz_collapsed_actions{display: none;}#serverpush_msg {margin-top: 20%;text-align: center;font-size: xx-large;}@media print {#header, #footer {display: none;}div.bz_query_buttons {display: none;}body {background-image: none;background-color: #fff;}}.field_label {text-align: right;vertical-align: top;font-weight: bold;}.field_help_link {cursor: help;}.field_value, form#Create th, form#Create td, .top {vertical-align: top;}.bottom {vertical-align: bottom;}.field_value .text_input {width: 100%;min-width: 25em;}.uneditable_textarea {max-width: 30em;font-size: medium;}th.required:before {content: "* ";}th.required:before, span.required_star {color: red;}input.required, select.required, span.required_explanation {background-color: #fff7cd;color: #000;}.calendar_button {background: transparent url(../../skins/standard/global/calendar.png) no-repeat;width: 20px;height: 20px;vertical-align: middle;}.calendar_button span { display: none }.yui-calcontainer {display: none;background-color: white;padding: 10px;border: 1px solid #404D6C;}.bug_urls {margin: 0;padding: 0;list-style-type: none;}pre.field_textarea_readonly {margin: 2px;padding: 4px;overflow: auto;float: left;max-width: 30em;max-height: 7em;border: 1px solid #CCC;font-family: monospace;white-space: pre-wrap;}.yui-skin-sam .yui-ac-input { position:static !important;vertical-align:middle !important; }.yui-skin-sam .yui-ac-container { left:0px !important; }.yui-skin-sam .yui-ac { display: inline-block; }#bugzilla-body .yui-ac-content {max-height: 19em;overflow: auto;overflow-x: hidden;}#keywords_container {padding-top: .2em;}#keywords_container .yui-ac-content {margin-left: -1px;}#comment_tabs {border-spacing: 0;}.comment_tab {display: table-cell;border: 1px solid silver;padding: 2px 1em;cursor: pointer;background: transparent;}.active_comment_tab {background: #fff;font-weight: bold;}#comment_preview {border: 1px solid silver;padding: 1px;overflow: auto;margin: 0px;}#comment_preview_text {margin: 0px;width: auto;}#comment_preview_loading {font-style: italic;}#comment {margin: 0px 0px 1em 0px;}.validation_error_text {font-size: 120%;color: #B70000;font-weight: bold;}.validation_error_field, input.validation_error_field {border: 2px solid #B70000;background-color: #FFEBEB;}form th {text-align: right;}.left {text-align: left;}.center {text-align: center;}.right {text-align: right;}.middle {vertical-align: middle;}.inline {display: inline;}tr.shared_search {background-color: #fff7cd;color: #000;}.multi-columns {columns: 3;-moz-columns: 3;-webkit-columns: 3;}#page-index {padding: 0.2em 0.2em 0.15em 0.2em;max-width: 1000px;}.intro, .outro {text-align: center;}#new_release {border: 2px solid red;padding: 0.5em 1em;margin: 1em;font-weight: bold;}#new_release .notice {font-size: 80%;font-weight: normal;}#welcome-admin a {font-weight: bold;}.bz_common_actions {text-align: center;}.bz_common_actions ul {list-style-type: none;padding: 0;}.bz_common_actions ul li {display: inline;vertical-align: top;}.bz_common_actions ul li a {display: inline-block;height: 170px;width: 145px;margin: 0 2ex 2em 0;}.bz_common_actions ul li a span {position: relative;top: 90%;font-weight: bold;}.bz_common_actions a,.bz_common_actions a:visited,.bz_common_actions a:hover {text-decoration: none;}#enter_bug { background: url(../../skins/standard/index/file-a-bug.png)  no-repeat; }#query     { background: url(../../skins/standard/index/search.png)      no-repeat; }#account   { background: url(../../skins/standard/index/new-account.png) no-repeat; }#help      { background: url(../../skins/standard/index/help.png)        no-repeat; }#quicksearchForm {clear: both;text-align: center;margin-bottom: 2em;}#quicksearchForm #quicksearch_main {width: 27em;}#quicksearchForm {margin: 0;padding: 0;}#page-index table {border-collapse: collapse;margin: auto;}#welcome {font-size: x-large;font-weight: bold;text-align: center;margin: 0 0 0.8em 0;padding: 0;}#common_queries ul {list-style: none;padding-left: 1.5em;}#common_queries li a {text-decoration: none;}ul#quicksearch_links {margin-bottom: 1em;}ul.additional_links {list-style: none;margin: 0;padding: 0;}ul.additional_links li {display: inline;}ul.additional_links li.bz_default_hidden {display: none;}body.narrow_page #bugzilla-body > * {max-width: 45em;}.req_new {color: red;}.req_table {border-collapse: collapse;}.req_table td, .req_table th {border: 1px solid black;padding: .25em;}.qs_help li {margin-top: 1ex;}.qs_fields th {padding: 0 .25em;}.qs_fields th.field_nickname {text-align: left;}.qs_fields td {padding: .25em;border-top: 1px solid gray;}.qs_fields .field_name {width: 10em;}table.field_value_explanation {table-layout: fixed;border-collapse: collapse;}.field_value_explanation thead h2 {margin: 0;}.field_value_explanation .header_row td {text-align: center;font-size: 120%;font-weight: bold;}.field_value_explanation tbody td {border: 1px solid black;padding: 1em;}.field_value_explanation dt, .field_descriptions dt {margin-top: 1em;}.field_descriptions dt {font-size: 120%;}#duplicates_table {border-collapse: collapse;}#duplicates_table .resolved {background-color: #d9d9d9;color: black;}#duplicates_table thead tr {background-color: #ccc;color: black;}#duplicates_table thead tr th {vertical-align: middle;}#duplicates_table td, #duplicates_table th {border: 1px solid black;padding: .1em .25em;}#duplicates_table tbody td {text-align: center;}#duplicates_table tbody td.short_desc {text-align: left;}
/* skins/standard/bug.css */
.enter_bug_form table {border-spacing: 0;border-width: 0;}.enter_bug_form td, .enter_bug_form th {padding: .25em;}.enter_bug_form th {text-align: right;}#Create #field_container_component {width: 1px;}#Create #field_container_reporter {width: 100%;}#Create .comment, #guided_form #description {vertical-align: top;overflow: auto;color: green;}#guided_form #description {display: inline;margin-left: 10px;}#Create #comp_desc_container td {padding: 0;}#Create #comp_desc {height: 11ex;}#Create #os_guess_note {padding-top: 0;}#Create #os_guess_note div {max-width: 35em;}#Create .field_value .text_input {max-width: 50em;}#possible_duplicates th {text-align: center;background: none;border-collapse: collapse;}#possible_duplicates td {vertical-align: middle;}#possible_duplicates .yui-dt-col-update_token {white-space: nowrap;}table#flags th, table#flags td,table#bug_flags th, table#bug_flags td,table#attachment_flags th, table#attachment_flags td {text-align: left;vertical-align: baseline;font-size: small;}.guided_form_field {background-color: #ffc;}#somebugs {width: 100%;height: 500px;}.good {color: #090;}.bad {color: #900;}.bz_short_desc_container {margin: 8px 0;padding: 0.3em;background-color: rgb(208, 208, 208);border-radius: 0.5em;font-size: 125%;font-weight: bold;}.bz_bug .edit_form {width: 100%;}.bz_bug .edit_form table {width: 100%;}.bz_bug #alias {min-width: 0;width: 10em;}table#flags {width: auto;}.bz_column_spacer {width: 0.5em;}.related_actions {font-size: 0.85em;float: right;list-style-type: none;white-space: nowrap;margin: 0;padding: 0;}.related_actions li {display: inline;}.navigation_link {color: #777;font-style: italic;}.bz_show_bug_column {vertical-align: top;}.bz_section_spacer {height: 1em;}#duplicate_settings {white-space: nowrap;}#bz_big_form_parts td {vertical-align: top;}.bz_group_visibility_section {margin-left: 1em;}.bz_group_visibility_section .instructions {font-style: italic;}#bz_restrict_group_visibility_help .instructions {margin-top: 0;}#bz_enable_role_visibility_help {margin-top: 1em;}.bz_time_tracking_table {border-collapse: collapse;}.bz_time_tracking_table th {text-align: center;}.bz_time_tracking_table td {text-align: center;}.bz_time_tracking_table th,.bz_time_tracking_table td {padding: 4px;}.bz_time_tracking_table .bz_summarize_time {text-align: right;}.bz_time_tracking_table #deadline {width: 7em;}#summary tr td {vertical-align:top;}#status {margin-bottom: 3ex;}.knob-buttons {float: right;}.text_input, .bz_userfield, #keywords_container, #tag_container {width: 100%;}.bz_bug .bz_short_desc_container {width: inherit;}.bz_comment_tags {margin-top: 3px;}.bz_comment_tag {border: 1px solid #c8c8ba;padding: 1px 3px;margin-right: 2px;border-radius: 0.5em;background-color: #eee;color: #000;}#bz_ctag_div {display: inline-block;}#bz_ctag_error {border: 1px solid #ff6666;padding: 0px 2px;border-radius: 0.5em;margin: 2px;display: inline-block;}#comment_tags_collapse_expand_container {padding-top: 1em;}#comment_tags_collapse_expand {list-style-type: none;padding-left: 1em;}#comment_tags_collapse_expand li {margin-bottom: 0px;}ul.tree {padding-left: 0em;margin-left: 1em;display: block;}ul.tree ul {padding-top: 3px;display: block;}ul.tree li {padding-top: 3px;text-indent: -1.2em;padding-left: 0.5em;padding-bottom: 3px;list-style-type: none;background: url(../../skins/standard/dependency-tree/bug-item.png) no-repeat;}ul.tree li a.b {padding-left: 30px;margin-right: -14px;text-decoration: none;}ul.tree li a.b_open {background: url(../../skins/standard/dependency-tree/tree-open.png) center no-repeat;cursor: pointer;}ul.tree li a.b_closed {background: url(../../skins/standard/dependency-tree/tree-closed.png) center no-repeat;cursor: pointer;}ul.tree a.tree_link img {border: 0;}.summ_info {display: none;font-size: 75%;}.hint {font-size: 90%;margin: 0.2em;padding: 0.1em;}.hint h3, .hint ul {margin-top: 0.1em;margin-bottom: 0.1em;}.summ A, .summ_deep A {text-decoration: none;color: darkblue;}.summ_h A {background-color: #ffffaa;color: #333;font-weight: bold;}.dependency_tree_controls input[type=submit] {min-width: 3em;}table.attachment_entry th {text-align: right;vertical-align: baseline;white-space: nowrap;}table.attachment_entry td {text-align: left;vertical-align: baseline;padding-bottom: 5px;}.file_head {font-weight: bold;font-size: 1em;background-color: #c3c3c3;border: 1px solid black;}.file_head a {text-decoration: none;font-family: monospace;font-size: 1.1em;}.file_collapse {display: none;}.section_head {background-color: #f0f0f0;border: 1px solid black;text-align: left;padding: 0.2em;}.section_head .link_here {float: right;padding-left: 1em;padding-right: 0.5em;}.lines_count a {padding-left: 0.5em;padding-right: 1em;}table.file_table {table-layout: fixed;width: 100%;empty-cells: show;border-spacing: 0px;border-collapse: collapse;border-bottom: 1px solid black;}tbody.file pre {display: inline;font-size: 0.9em;}tbody.file pre:empty {display: block;}.changed {background-color: lightblue;}.added {background-color: lightgreen;}.removed {background-color: #FFCC99;}.num {background-color: #ffe9ae;text-align:right;padding: 0 0.3em;width: 3em;}table.attachment_info th {text-align: right;vertical-align: top;}table.attachment_info td {text-align: left;vertical-align: top;}#noview {text-align: left;vertical-align: middle;}#attachment_attributes div {padding-bottom: 0.4em;}#attachment_attributes label {font-weight: bold;}#attachment_attributes .block {display: block;}#smallCommentFrame, #attachment_flags {float: left;}#smallCommentFrame {margin-right: 1.5em;}#attachment_comments_and_flags, #attachment_actions {clear: both;margin-bottom: 1ex;}#attachment_information_read_only .title {font-weight: bold;font-size: 1.5em;padding: 0;margin: 0;}#attachment_information_read_only .title #bz_edit {font-size: 0.7em;}#attachment_information_read_only .details {font-size: 90%;}#attachment_info.read #attachment_information_edit {display: none;}#attachment_info.edit #attachment_information_read_only {display: none;}#attachment_info.edit #attachment_view_window {float: left;width: 80%;}#attachment_info.edit #attachment_information_edit {width: 20%;}#attachment_info.edit #attachment_information_edit input.text,#attachment_info.edit #attachment_information_edit textarea {width: 90%;}#attachment_isobsolete {padding-right: 1em;}#attachment_information_edit {float: left;}#smallCommentFrame textarea {display: block;}textarea.bz_private {border: 1px solid #F8C8BA;}#update {clear: both;display: block;}div#update_container {clear: both;padding: 1.5em 0;}#attachment_flags {margin-bottom: 1em;}#attachment_flags p {padding-bottom: 0;margin-bottom: 0;}#editFrame, #viewDiffFrame, #viewFrame {height: 400px;width: 95%;margin-left: 2%;}.viewall_frame_container {width: 75%;margin: 2em auto;}.viewall_desc {width: 100%;border: 1px solid black;border-spacing: 0px;border-collapse: collapse;}.viewall_desc th, .viewall_desc td {border: 1px solid black;padding: 0.3em;}.viewall_frame {width: 100%;height: 350px;}.no_javascript .bz_hide, .no_javascript .bz_edit {display: none;}#hidden_obsolete_message {text-align: left;width: 75%;margin: 0  auto;font-weight: bold;}
/* skins/contrib/Dusk/global.css */
body {background: #c8c8c8;font-family: Helvetica, Arial, Geneva;padding-left: 1em;padding-right: 1em;}#titles {border-top-left-radius: 5px;border-top-right-radius: 5px;}#header .links, #footer {background-color: #929bb1;color: #ddd;}#header {border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;border: none;}#header a, #footer a {color: white;text-decoration: none;}#header a:hover, #footer a:hover {text-decoration: underline;}#bugzilla-body {background: #f0f0f0;color: black;border: 1px solid #747e93;padding: 10px;font-size: 10pt;border-radius: 5px;}a {color: #6070cf;}a:hover {color: #8090ef;}hr {border-color: #969696;border-style: dashed;border-width: 1px;margin-top: 10px;}#bug-form td {padding-top: 2px;}#attachment-list {border: 2px solid #c8c8ba;font-size: 9pt;}#attachment-list th {background-color: #e6e6d8;border: none;border-bottom: 1px solid #c8c8ba;text-align: left;}#attachment-list th a {color: #646456;}#attachment-list td {border: none;}#attachment-list-actions td {border-top: 1px solid #c8c8ba;}#comments th {font-size: 9pt;font-weight: bold;padding-top: 5px;padding-right: 5px;padding-bottom: 10px;text-align: right;vertical-align: top;white-space: nowrap;}#comments td {padding-top: 2px;}.reply-button a {padding-left: 2px;padding-right: 2px;}.bz_comment {background-color: #e8e8e8;margin: 1px 1px 10px 1px;border-width: 1px;border-style: solid;border-color: #c8c8ba;padding: 5px;font-size: 9pt;}.bz_comment_head, .bz_first_comment_head {margin: 0; padding: 0;background-color: transparent;font-weight: bold;}.bz_comment_user {margin-left: 0;}.bz_comment.bz_private {background-color: #f0e8e8;border-color: #f8c8ba;}.comment_rule {display: none;}#footer {border: 1px solid #747e93;width: 100%;border-radius: 5px;}#footer #links-actions,#footer #links-edit,#footer #links-saved,#footer #links-special {margin-top: 2ex;}#footer .links {border-spacing: 30px;margin-bottom: 2ex;}.separator {color: #cccccc;}.tabbed .tabbody {background: #f8f8f8;padding: 1em;border-style: solid;border-color: #000000;border-width: 0 3px 3px 1px;}.tabs {margin: 0;padding: 0;border-collapse: collapse;}.tabs td {background: #c8c8c8;border-width: 1px;}.tabs td.selected {background: #f8f8f8;border-width: 1px 3px 0 1px;}.tabs td.spacer {background: transparent;border-top: none;border-left: none;border-right: none;}.bz_row_odd {background-color: #f0f0f0;}#page-index .outro {clear:both;}@media print {#header,#footer,.navigation {display: none;}body {background-image: none;background-color: #ffffff;}#bugzilla-body {border: none;margin: 0;padding: 0;}}
</style>

<style>/* skins/custom/global.css */
#banner > div {border-radius: 5px;}#banner a {color: #6070cf}
</style>

    


    


    

    
    <link rel="search" type="application/opensearchdescription+xml" title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><link href="https://c.s-microsoft.com/mscc/statics/mscc-0.4.1.min.css" rel="stylesheet" type="text/css">

      

    <style>.wrapper {
    margin: 0 auto;
    box-sizing: border-box;
    -ms-box-sizing: border-box;
}

#global-footer {
    background-color: #354b60;
}

#global-footer li,#global-footer ul {
    list-style: none;
    padding: 0;
    border: 0;
    margin: 0;
    font: inherit;
    color: inherit;
    line-height: normal
}

#global-footer footer {
    margin-top: 60px;
    background: rgba(44,62,80,.5);
    clear: both;
    padding: 30px;
    margin: 0;
    font-size: 14px;
    color: #ecf0f1;
}

#global-footer footer .wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    /* align-items:center; */
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
}

#global-footer footer .microsoft-logo img {
    display: block;
    margin: 0 auto;
    width: 110px;
}

#global-footer footer .contact {
    text-align: left
}

#global-footer footer .legal {
    text-align: right
}

#global-footer footer a,#global-footer footer span {
    padding: 0 10px
}

#global-footer footer a {
    color: inherit;
    text-decoration: none;
}

#global-footer footer a:hover {
    color: #fff;
    text-decoration: none;
}

#global-footer .sub-footer {
    background-color: #233140;
    color: hsla(0,0%,100%,.7);
    font-size: 14px;
    padding: 3px;
    -webkit-font-smoothing: antialiased;
    -moz-font-smoothing: antialiased
}

@media (max-width: 992px) {
    html:not(.non-responsive) #global-footer footer {
        padding:0
    }

    html:not(.non-responsive) #global-footer footer .wrapper {
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        max-width: 430px
    }

    html:not(.non-responsive) #global-footer footer .microsoft-logo {
        -webkit-box-ordinal-group: 1;
        -ms-flex-order: 0;
        order: 0
    }

    html:not(.non-responsive) #global-footer footer .wrapper>:not(.microsoft-logo) {
        -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
        order: 1
    }

    html:not(.non-responsive) #global-footer footer .contact,html:not(.non-responsive) #global-footer footer .legal,html:not(.non-responsive) #global-footer footer .microsoft-logo {
        float: none;
        padding: 20px 0;
        text-align: center
    }

    html:not(.non-responsive) #global-footer footer .contact,html:not(.non-responsive) #global-footer footer .legal {
        padding-top: 0
    }
}
</style>
  </head>

  <body class="bugzilla-xamarin-com
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_iOS
                 bz_component_General
                 bz_bug_23806 yui-skin-sam">

  <div id="header">

    <div id="titles">
      <span id="title">Bugzilla – Bug&nbsp;23806</span>

        <span id="subtitle" class="subheader">HttpWebRequest fails after wifi change</span>

        <span id="information" class="header_addl_info">Last modified: 2016-12-22 14:21:08 UTC</span>
    </div>


    <div id="common_links">
    </div>
  </div>

  <div id="bugzilla-body">




<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2016-12-22 14:21:08">
  <input type="hidden" name="id" value="23806">
  <input type="hidden" name="token" value="1559158921-OphZ-m9yxHNEuYxFbPaAHrv26SRFit-DlLG3Sd_NgJ4">
<div class="bz_short_desc_container edit_form">
     <a href="bug.html"><b>Bug&nbsp;23806</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">HttpWebRequest fails after wifi change</span>
     </span>

    <div id="summary_input"><span class="field_label " id="field_label_short_desc">


  <a title="The bug summary is a short sentence which succinctly describes what the bug is about." class="field_help_link" href="#">Summary:</a>

</span>HttpWebRequest fails after wifi change
    </div>
  </div>
  
  <table class="edit_form">
    <tbody><tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">
        <table>
          <tbody><tr>
    <th class="field_label">
      <a href="#">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          DUPLICATE
            of <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed" title="VERIFIED FIXED - After network reconnected, web request fails for a couple of minutes with a NameResolutionFailure" href="https://bugzilla.xamarin.com/show_bug.cgi?id=45761">bug 45761</a>
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_alias">


  <a title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla." class="field_help_link" href="#">Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_product">


  <a title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list." class="field_help_link" href="#">Product:</a>

</th>
  <td class="field_value " id="field_container_product">iOS

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label " id="field_label_classification">


  <a title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation." class="field_help_link" href="#">Classification:</a>

</th>
  <td class="field_value " id="field_container_classification">Xamarin

</td>
    </tr>
    
    
    
    <tr><th class="field_label " id="field_label_component">


  <a title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list." class="field_help_link" href="#">Component:</a>

</th>
  <td class="field_value " id="field_container_component">General

  ()
</td>
    </tr>
    <tr><th class="field_label " id="field_label_version">


  <a title="The version field defines the version of the software the bug was found in." class="field_help_link" href="#">Version:</a>

</th>
<td>XI 8.2.0
  </td>
    </tr>
    
    
    
    <tr><th class="field_label " id="field_label_rep_platform">


  <a title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;." class="field_help_link" href="#">Hardware:</a>

</th>
      <td class="field_value">PC
        Mac OS
      </td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
      <th class="field_label">
        <label accesskey="i">
          <a href="#"><u>I</u>mportance</a></label>:
      </th>
      <td>Normal
       major
      </td>
    </tr>

      <tr><th class="field_label " id="field_label_target_milestone">


  <a title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it." class="field_help_link" href="#">Target Milestone:</a>

</th><td>Untriaged
  </td>
      </tr>

          <tr><th class="field_label " id="field_label_assigned_to">


  <a title="The person in charge of resolving the bug." class="field_help_link" href="#">Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
      </td>
    </tr>

    
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label " id="field_label_bug_file_loc">


  <a title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen." class="field_help_link" href="#">URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label " id="field_label_dependson">


  <a title="The bugs listed here must be resolved before this bug can be resolved." class="field_help_link" href="#">Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>

  <tr><th class="field_label " id="field_label_blocked">


  <a title="This bug must be resolved before the bugs listed in this field can be resolved." class="field_help_link" href="#">Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>

        </tbody></table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tbody><tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2014-10-13 23:22 UTC by <span class="vcard"><span class="fn">Cody Beyer (MSFT)</span>
</span>
    </td>
  </tr>

  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2016-12-22 14:21 UTC
      (<a href="activity.html">History</a>)
    </td>

  </tr>
<tr>
      <th class="field_label">
        <label accesskey="a">
          CC List:
        </label>
      </th>
      <td>13
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="adrian.murphy">adrian.murphy</option>
                <option value="alain.rogister">alain.rogister</option>
                <option value="alangley">alangley</option>
                <option value="arpitj">arpitj</option>
                <option value="brendan.zagaeski">brendan.zagaeski</option>
                <option value="chrisntr">chrisntr</option>
                <option value="kpickard">kpickard</option>
                <option value="mono-bugs+monotouch">mono-bugs+monotouch</option>
                <option value="reinaldo.pires">reinaldo.pires</option>
                <option value="sa">sa</option>
                <option value="sebastien">sebastien</option>
                <option value="svento">svento</option>
                <option value="tj">tj</option>
            </select>
        </div>
          
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr>
      <th class="field_label " id="field_label_cf_tags">


  <a title="A custom Free Text field in this installation of Bugzilla." class="field_help_link" href="#">Tags:</a>

</th>
  <td class="field_value " id="field_container_cf_tags">

</td>
    </tr>
    <tr>
      <th class="field_label " id="field_label_cf_bug_regression">


  <a title="If this bug is not a regression select no, otherwise select yes and complete the &quot;last known good build&quot; entry." class="field_help_link" href="#">Is this bug a regression?:</a>

</th>
  <td class="field_value " id="field_container_cf_bug_regression">---

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field" id="field_label_cf_bug_regression_build">


  <a title="What is the last known good build? (e.g. C7, 4.5.x, etc.)" class="field_help_link" href="#">Last known good build:</a>

</th>
  <td class="field_value  bz_hidden_field" id="field_container_cf_bug_regression_build">

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </tbody></table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </tbody></table>

  <table id="bz_big_form_parts">
  <tbody><tr>
  <td>

    


<br>
<table id="attachment_table">
  <tbody><tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_zip">
        <td>
            <a href="https://bugzilla.xamarin.com/attachment.cgi?id=8408&amp;file=NoWorkAfterNetworkChange.zip" title="View the content of the attachment">
          <b>TestCase</b></a>

          <span class="bz_attach_extra_info">
              (13.42 KB,
                application/zip)

            <br>
            <a href="#attach_8408" title="Go to the comment associated with the attachment">2014-10-13 23:22 UTC</a>,

            <span class="vcard"><span class="fn">Cody Beyer (MSFT)</span>
</span>
          </span>
        </td>


        <td>
          <a href="https://bugzilla.xamarin.com/attachment.cgi?id=8408&amp;file=NoWorkAfterNetworkChange.zip">Details</a>
        </td>
      </tr>

  
</tbody></table>
<br>

  </td>
  <td>
  </td>
  </tr></tbody></table>
<hr>

<div id="add_comment" class="bz_section_additional_comments">
<div class="box" style="margin: 1px 1px 10px 1px; max-width: 47.8em">
    <p>
        <strong>Notice (2018-05-24)</strong>: bugzilla.xamarin.com is now in
        <strong>read-only</strong> mode.
    </p>
    <p>
        Please join us on
        <a href="https://developercommunity.visualstudio.com/spaces/8/index.html">
        Visual Studio Developer Community</a> and in the
        <a href="https://github.com/xamarin">Xamarin</a> and
        <a href="https://github.com/mono">Mono</a> organizations on
        GitHub to continue tracking issues. Bugzilla will remain
        available for reference in read-only mode. We will continue to work
        on <strong>open</strong> Bugzilla bugs, copy them to the new locations
        as needed for follow-up, and add the new items under <strong>Related
        Links</strong>.
    </p>
    <p>
        Our sincere thanks to everyone who has contributed on this bug
        tracker over the years. Thanks also for your understanding as we
        make these adjustments and improvements for the future.
    </p>
    <hr><p>
        <strong>Please create a new report</strong> on 
        <a href="https://docs.microsoft.com/visualstudio/ide/how-to-report-a-problem-with-visual-studio-2017">Developer Community</a> or <a href="https://github.com/xamarin">GitHub</a> with
        your current version information, steps to reproduce, and relevant error
        messages or log files if you are hitting an issue that looks similar to
        this resolved bug and you do not yet see a matching new report.
    </p>
</div>

    <div style="margin: 4ex 0">
        <table><tbody><tr><th class="field_label " id="field_label_see_also">


  <a title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields." class="field_help_link" href="#">Related Links:</a>

</th>
  <td class="field_value " id="field_container_see_also">

</td>
    </tr>
        </tbody></table>
    </div>

    <table id="bug_status_bottom" class="status">
        <tbody><tr>
            <th class="field_label">
                <a href="#">Status</a>:
            </th>
            <td><div id="status">RESOLVED

    <noscript><br>resolved as </noscript>

  <span id="resolution_settings">DUPLICATE
  </span>

    <noscript><br> duplicate</noscript>
    <span id="duplicate_display">of <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed" title="VERIFIED FIXED - After network reconnected, web request fails for a couple of minutes with a NameResolutionFailure" href="https://bugzilla.xamarin.com/show_bug.cgi?id=45761">bug 45761</a></span>
</div>


            </td>
        </tr>
    </tbody></table>

</div>
    <hr>

  
  <div id="comments">




<!-- This auto-sizes the comments and positions the collapse/expand links
     to the right. -->
<table class="bz_comment_table">
<tbody><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Cody Beyer (MSFT)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-13 23:22:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="https://bugzilla.xamarin.com/attachment.cgi?id=8408&amp;file=NoWorkAfterNetworkChange.zip" name="attach_8408" title="TestCase">attachment 8408</a> <a href="https://bugzilla.xamarin.com/attachment.cgi?id=8408&amp;file=NoWorkAfterNetworkChange.zip" title="TestCase">[details]</a></span>
TestCase

The attached app demonstrates the issue and I have reproduced it on an iPhone

Description of Issue:
* User is connected to WiFi access point called 'Network A' running our iPad app
* User successfully calls a web service and gets data back
* User moves locations and connects to WiFi access point called 'Network B' without re-starting the application
* User attempts to call the same web service. The Request times out.
* If the user terminates the application and restarts it while still on 'Network B' the service call will work. If the user re-joins 'Network A' the request works again

To reproduce using the attached project:

1. Make sure the iPad is connected to a wireless network
2. Launch the "NoWorkAfterNetworkChange" app to a physical iPad device.
3. Tap the "Use HttpWebRequest" button -&gt; after a brief delay you should see a message that says "Success: true" which means the service call was successful
4. Tap the "Use NSUrlRequest" button-&gt; after a brief delay you should see a message that says "true" which means the service call was successful
5. Without killing the app, go to device settings and switch the wireless networks. After you have joined a different network return to the app.
6. Tap "Use HttpWebRequest" -&gt; after waiting for 7 seconds, the service call will timeout. This will eventually happen regardless of what the timeout is set to.
7. Tap "Use NSURLRequest" -&gt; you should see "true" which means this was still successful</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Arpit Jha</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-14 06:46:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">I have checked this and unable to reproduce it

I tried to reproduce with the help of bug description and observed that getting success message on Httpwebrequest and NSURLRequest button click after changing Network LAN to wifi  we clicked on Httpwebrequest getting a popup of "Failure:Timeout" and when clicked on NSURLRequest getting  an exception of 
"System.ArgumentNullException"

Screencast regarding same:
<a href="http://www.screencast.com/t/k2nU6oAA">http://www.screencast.com/t/k2nU6oAA</a>

Let me know if I missed anything to reproduce it.

Environment Info:
=== Xamarin Studio ===

Version 5.6.1 (build 5)
Installation UUID: 6ea47b0d-1852-4aaf-808d-373ff0a5002b
Runtime:
 Mono 3.10.0 ((detached/633e444)
 GTK+ 2.24.23 (Raleigh theme)

 Package version: 310000020

=== Apple Developer Tools ===

Xcode 6.0.1 (6528)
Build 6A317

=== Xamarin.Mac ===

Version: 1.10.0.18 (Business Edition)

=== Xamarin.Android ===

Version: 4.18.0 (Business Edition)
Android SDK: /Users/jatin66/Desktop/Backup/android-sdk-macosx
 Supported Android versions:
  1.6   (API level 4)
  2.1   (API level 7)
  2.2   (API level 8)
  2.3   (API level 10)
  3.0   (API level 11)
  3.1   (API level 12)
  3.2   (API level 13)
  4.0   (API level 14)
  4.0.3 (API level 15)
  4.1   (API level 16)
  4.2   (API level 17)
  4.3   (API level 18)
  4.4   (API level 19)
Java SDK: /usr
java version "1.7.0_65"
Java(TM) SE Runtime Environment (build 1.7.0_65-b17)
Java HotSpot(TM) 64-Bit Server VM (build 24.65-b04, mixed mode)

=== Xamarin.iOS ===

Version: 8.2.0.203 (Business Edition)
Hash: 6049af6
Branch: 
Build date: 2014-10-12 21:49:14-0400

=== Build Information ===

Release ID: 506010005
Git revision: 4a603dc77610b9eff2a41582146c56b69a81ceba
Build date: 2014-10-09 11:07:06-04

=== Operating System ===

Mac OS X 10.9.5
Darwin Jatin66s-iMac.local 13.4.0 Darwin Kernel Version 13.4.0
    Sun Aug 17 19:50:11 PDT 2014
    root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-14 09:16:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">I see that you marked the bug as unable to reproduce.  
In the problem description I had put the following: 

"Launch the "NoWorkAfterNetworkChange" app to a physical iPad device.”   

In other words I mean an actual iPad, not the iOS simulator.  Please re-test using a physical device.  if you follow the directions, I think its fairly easy to reproduce.

@Cody Beyer was also able to reproduce so perhaps check with him as well.  This issue is having a big affect on our production users.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Cody Beyer (MSFT)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-14 10:56:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">Two items of note

1) This only happens on a physical device

2) The recreation instructions request that this be tested with wifi only such as:

2a) turn off cellular radio
2b) connect to wifi
2c) test app
2d) background (not close) app
2e) switch to a /different/ wifi network
2f) test

It can be hard to switch networks, I had to connect to a public wifi for the 2nd attempt, but it is vital to the testing that this be done.

Thanks</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastien Pouliot</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-03 14:12:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">Our HttpWebRequest comes directly from Mono -&gt; Martin

Note: if anyone knows a version of XI that worked previously (if it's a regression) that could be helpful to poinpoint the change. Thanks!</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Adrian Murphy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-17 18:16:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel - Assigning to you for your comments, as per our discussion.</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-22 09:37:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hi, 

I have the same problem with my application. That's very important for us to resolve this problem faster.

Thank you

Alain</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-22 09:58:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hey guys,

Let me share with you my debugging thoughts on the issue.

The issue is that the kernel is not shutting down sockets when the IP address on the host changes.   

What happens is that when you hop from one wifi network to another wifi network, the IP changes, but the connection is technically no longer usable.   But an application that keeps a socket open has no way of knowing this.

So what we need to do is hook up the Reachability stack, and when we detect a network change, invalidate the internal cached set of connections.

There are two options: 

* use the native NSUrlConnection/NSUrlSession or CFNetwork stack that does this already.

* Implement a reachability check, and when the network changes, use internal calls to clear the cached ServicePoint data structures.

I will try to get a prototype of the latter for you over the weekend.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-22 10:00:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">In case someone does not want to wait for my prototype, this is the source code for the ServicePointManager where we need to clear the connections on IP address change:

<a href="https://github.com/mono/mono/blob/master/mcs/class/System/System.Net/ServicePointManager.cs">https://github.com/mono/mono/blob/master/mcs/class/System/System.Net/ServicePointManager.cs</a></pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-22 10:39:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">OK, thank you !

 I'll wait for your prototype for it.

I saw this problem by changing the 4G to WIFI and it is the same problem that a change in WIFI wireless network to another.

Let me know when you have a solution.

Thank you for your quick response.

Alain</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-24 09:08:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hi,

are you found a solution for us ?

Thanks

Alain</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-24 22:07:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">Two problems:

(a) I am unable to reproduce this problem with my test networks, so there might be something else going on that I do not understand.  Perhaps a keep-alive on the HTTP client?   And perhaps the solution is to disable keep-alive?

(b) The reachability class is not as useful as I thought it was, it merely lets you know when access to a particualr host/endpoint changes, but not necessarily that a network configuration changes.   So changes from one wifi-network to another would not be detected.

Sample code below to detect this


			try {
				reachability = new NetworkReachability ("www.google.com");

			} catch {
			}
			if (reachability != null) {
				reachability.SetCallback ((flags) =&gt; {
					l.Text = String.Format ("Rechability: {0}", flags);
                                });
				reachability.SetDispatchQueue (MonoTouch.CoreFoundation.DispatchQueue.MainQueue);
				reachability.Schedule ();</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T.J. Purtell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-25 02:26:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Does WebConnectionStream have a SendTimeout/WriteTimeout on the socket it is using?  Default per POSIX is infinite, so it will never detect the connection is "dead" if the router just DROPs vs REJECTs the packets.  I couldn't find a timeout and it looks like it is using blocking IO ops on a thread pool, so the SO_SNDTIMEO might apply.</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-25 10:11:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel - Here's the code I'm using in my test case.  I don't think the keep-alive is being set unless that's happening somewhere under the covers.  Have you tried the sample I uploaded?  Its very easily reproduced for me.  

This will timeout after a wifi network change:

var uri = new Uri("<a href="https://api-stg.flightdocs.com/apitest/get">https://api-stg.flightdocs.com/apitest/get</a>");
HttpWebRequest r = new HttpWebRequest(uri);
r.Timeout = 7000;
r.Method = "GET";
using(var response = r.GetResponse())
{
	var encoding = ASCIIEncoding.ASCII;
	string responseText;
	using (var reader = new System.IO.StreamReader(response.GetResponseStream(), encoding))
	{
		responseText = reader.ReadToEnd();
	}
	response.Close();
	return "Success: " + responseText;
}  


I have had partial success with using the following code after a network change, however I don't understand it so I'm hesitant to put it into production.  Also as you said, the reachability class won't notify of a simple switch in networks:

var uri = new Uri("<a href="https://api-stg.flightdocs.com/apitest/get">https://api-stg.flightdocs.com/apitest/get</a>");
var svcPoint = ServicePointManager.FindServicePoint(uri);
var closed = svcPoint.CloseConnectionGroup(null);

Brainstorming... Regarding the network switch, could we do something like this to check the SSID to detect a different network?  This could be run whenever the app comes to the foreground to detect a manual network change.  However, if the device went out of range of one network and then automatically joined a different one while the app is still in the foreground this wouldn't help.  In that scenario though, I'm hoping Reachability would notify us.  

static string GetSSID ()
{
    var dict = CaptiveNetwork.CopyCurrentNetworkInfo ("en0");
    return dict [CaptiveNetwork.NetworkInfoKeySSID].ToString ();
}</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 12:43:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">My issue is just that I do not have a network configuration to reproduce this at this point.   At home, where I have two access points, they both route through the same router at the end, so I suspect that is why I am unable to repro.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 12:57:56 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel

To reproduce this bug, you put yourself on an iPad WIFI =&gt; it works.

You cut WIFI and you're on 3G-4G, you call your WebService and you have a direct connection TimeOut.

It's really urgent that you find a solution to this problem for many of our customers switch between WiFi and 4G, and they must each time attempting to restart the application.

thank you

Alain</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 14:14:21 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel - I've come up with a workaround until you can figure out a long-term solution.  Could you take a look and give me your opinion if you see any pitfalls with what I've come up with or, if there's a better way to implement this workaround?

Here's what I'm doing:

Once there are no pending calls, I manually call ServicePoint.CloseConnectionGroup(...) in order to force close the open connections.  When doing this, the connection will get re-opened with each new set of requests and therefore its unlikely that a user will encounter the problem when switching networks.  This is what closes the connection:

var sp = ServicePointManager.FindServicePoint(new Uri("<a href="https://api-test.Flightdocs.com/">https://api-test.Flightdocs.com/</a>"));
sp.CloseConnectionGroup(null);

All my API calls have the same base address and therefore share the same ServicePoint instance which makes it easy for me to do this across the board.   The issue is that this can't always be done after every network call finishes since it could cause other requests that are being performed on other threads to fail.  So, I've come up with a way of tracking open network requests and then closing once there are no longer any pending ones.  

I've put together a Gist that shows the full approach.  I would very much appreciate if you could take a look and let me know what you think:  <a href="https://gist.github.com/kentpickard/ba94e62febd92a3d35bc">https://gist.github.com/kentpickard/ba94e62febd92a3d35bc</a>  

I agree with Alain that the impact of this is very large.  Our application is used by pilots which are constantly on the move and switching between wireless networks as well as between WiFi and Cellular.  This is a big issue for them and I have been under pressure to provide a resolution since I originally opened this bug over a month ago.  

I'm very glad to see that one of the famous Mono pioneers, Miguel, is on the case.  It gives me confidence that it will get resolved soon :-)</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 16:26:48 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ok, some comments:

(a) your approach is correct, this will shut down the cached values.  So the issue remains one of finding out when the IP address changes.

(b) The issue in *particular* with this web site is that it keeps the connection open, this is what causes the time out.   A simple fix to this problem is to add to your HttpWebRequest the following:

myWebrequest.KeepAlive = false

Which will shutdown the connection, and insure that the cached value is not used the next time.</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T.J. Purtell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 19:37:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">1) -- Ideal working no network change --
Request A initiated by app
Connection opened
Request A sent
Response A received
Request B initiated by app
Request B sent
Response B received

2) -- Ideal working with network change -- 
Request A initiated by app
Connection opened
Request A sent
Response A received
Network change
Mono evicts Keep-Alive connections or kernel invalidates the connection
Request B initiated by app
Connection opened
Request B sent
Response B received

3) -- Should still work with retry ---
Request A initiated by app
Connection opened
Request A sent
Response A received
Network change
Request B initiated by app
Request B sent (on dead connection)
Request B fails with timeout etc, Connection marked dead by mono **??
Request B re-initiated by app
Connection opened
Request B sent
Response B received

4) -- Workaround KeepAlive = false, extra SSL connect per request required for normal use --
Request A initiated
Connection opened
Request A sent
Response A received
(Network change or not, no difference in behavior)
Request B initiated by app
Connection opened
Request B sent
Response B received

I think that in general an application wants keep alive for performance, and needs to support retry from its own application logic (automatic retry and/or user triggered retry), so at the app level things should be coded to support the style of (3), but ideally mono/kernel would help the situation a bit with detecting the change and usually the situation would be (2).

From the comments above (and my own experience with network changes on mobile mono from the last time we tried wide deployment of the mono http stack), it seems like situation 3, doesn't work right.  If killing the application is required to enable a request to eventually succeed, maybe it means that the "failed via timeout"  request (see **?? above) did not cause the KeepAlive connection to be evicted from the pool, even though that connection shouldn't be eligible for reuse because it has a pending operation which was aborted due to timeout.</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 19:52:03 UTC
        </span>

      </div>




<pre class="bz_comment_text">After a timeout, the connection gets evicted from the pool.  This is scenario (2), with the added caveat that it will happen after the timeout expires.   Apple's documentation states that you are supposed to retry these operations:

<a href="https://developer.apple.com/library/ios/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/WhyNetworkingIsHard/WhyNetworkingIsHard.html">https://developer.apple.com/library/ios/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/WhyNetworkingIsHard/WhyNetworkingIsHard.html</a>

Your scenario (3) works today.   It is obnoxious, because you have to wait for the timeout, but it works.

The issue with the KeepAlive is that the kernel will happily keep the connection *alive* and will queue any messages you send to it without returning any indication that the network interface has been shut down hoping that you might come back and flush the data out.

You can observe this behavior by switching from one network to another network (the socket continues to be kept alive) and then switching back, and the data will be flushed once the original interface with the original IP address go back.

The timeout message is not raised by the kernel, instead it is raised by the .NET runtime when it determines that the timeout for the connection has expired.

So in short, 3 and 4 is what you can do today.   

To achieve (2) we need to find a reliable way of detecting a network change (which does not seem simple to do, as the Reachability API does not tell you if a network configuration changed, merely whether you can reach a certain host if you initiate a new connection).

Another area of investigation is to use the local IP address as a key for reusing connection groups.   So if the local address is different than the local address of the interface that was used on first connection, we could invalidate this.

It seems flaky, and  might also slow down every HTTP request by forcing us to scan all network interfaces on each new connection.   Perhaps not a big deal.</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">T.J. Purtell</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 23:17:12 UTC
        </span>

      </div>




<pre class="bz_comment_text">Great :) 

If (3) is working, then we can soon start detailed testing to switch back to the mono http stack from the NativeHttpHandler.  I think we have to wait for <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed" title="RESOLVED FIXED - Mono HttpClientHandler does not support concurrent requests (Corrupts state)" href="https://bugzilla.xamarin.com/show_bug.cgi?id=22724">https://bugzilla.xamarin.com/show_bug.cgi?id=22724</a> to be released though.  Will report back more when this happens.</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-29 07:32:36 UTC
        </span>

      </div>




<pre class="bz_comment_text">Sorry but I don't understand what I do.

In my application ,I test if I have a network connection before calling my webservice via the class: Reachability

I have a WebService that I call like this:

DLLMedinect.EHealthConnectionWebService.Service EHealth DLLMedinect.EHealthConnectionWebService.Service = new ();


if (EHealth.CreateFallbackSession (strNumeroINAMI, strMotDePasse, Alangue, ref stcErreur) == true)
return true;
else
return false;

If I change my network, I have a connection timeout, what should I do practically?

Thank you

Alain</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-29 10:50:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">On your web request, set "KeepAlive" to false.</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-29 11:31:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel,

I use a WebReference and I don't have a WebRequest.

What do I do exactly with a WebReference ?

I don't see where I must to use KeepAlive

In my code, I have a WebReference : EHealthConnectionWebService

and I call the the function simply :

DLLMedinect.EHealthConnectionWebService.Service EHealth = new
DLLMedinect.EHealthConnectionWebService.Service();


if (EHealth.CreateFallbackSession (strNumeroINAMI, strMotDePasse, Alangue, ref
stcErreur) == true)
return true;
else
return false;</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-29 12:11:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">Alain,

I have no way of knowing what your EHEalthConnectionWebService is.

You are going to need to find in that class the property or setting that gets you access to the HttpWebRequest.

Perhaps you need to override the GetWebREquest method and customize there.</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-01 10:32:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel - Setting HttpWebRequest.KeepAlive=false is much simpler than what I'm doing.  However, I've discovered another (possibly related) bug that prevented me from discovering this when I tried doing that early on in my testing:

In addition to not detecting when the client IP address changes (which this bug entry addresses), the mono networking stack also does not detect when the host IP address is different after a network change.  Setting KeepAlive=False does not fix this issue.  

For example:  In our office we have 2 wireless networks:  Developers and Employees.  When on the Developers network, <a href="https://API-STG.flightdocs.com">https://API-STG.flightdocs.com</a> resolves to a different IP then when on the Employees network.  In this case, one is a public facing IP and the other is a local IP.  When switching from the Developer network to the Employees network it tries to re-use the cached IP address.  

This will be a problem for our production users in the future when we move to having multiple data centers in the cloud which we're currently working on putting in place.  If a pilot takes off on the east coast and then touches down on the west coast, the IP address of the host could change.  If the app is still running (it could be since the pilot could be using it in offline mode during the flight) then I think they'll have the same issue.  The only work-around I can think of for this is manually removing the ServicePoint entry via reflection but that could likely have a lot of unintended consequences.  NSUrlRequest somehow handles this gracefully. 

Should I open a new bug for this?</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-01 15:14:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hello,

Provided that your pilot does not fly from one point to another in less that 100 seconds (the time that an entry can stay in the ServicePointManager before it gets evicted), that should not be a problem.

That said, you can use the ServicePointManager.MaxServicePointIdleTime to change this from the default of 100 seconds to any other values that are more suitable.   

Come to think of it, setting this to a low value is probably a better idea than setting the KeepAlive to false.

Here is a good explanation:

<a href="http://blogs.msdn.com/b/jpsanders/archive/2009/05/20/understanding-maxservicepointidletime-and-defaultconnectionlimit.aspx">http://blogs.msdn.com/b/jpsanders/archive/2009/05/20/understanding-maxservicepointidletime-and-defaultconnectionlimit.aspx</a></pre>
    </div>

    <div id="c34" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-01 16:05:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel - From what I'm seeing, setting the ServicePointManager.MaxServicePointIdleTime to something low (like 500 milliseconds) did not help with the problem of the Host IP address changing.  (It is indeed another way to address the problem of the client IP address changing)

With this code the network calls still fails after switching from Developer to Employee networks and waiting more than 100 seconds between calls (I should only have to wait a half second).  I think that open connections are shut down by setting max idle time however, the ServicePoint entry still keeps the old host IP address with that was previously resolved.  Here's the example:

ServicePointManager.MaxServicePointIdleTime = 500;

var uri = new Uri("<a href="https://api-stg.flightdocs.com/apitest/get">https://api-stg.flightdocs.com/apitest/get</a>");
HttpWebRequest r = new HttpWebRequest(uri);
r.Timeout = 7000;
r.Method = "GET";
r.KeepAlive = false;
string responseText;
using(var response = r.GetResponse())
{
	var encoding = ASCIIEncoding.ASCII;

	using (var reader = new System.IO.StreamReader(response.GetResponseStream(), encoding))
	{
		responseText = reader.ReadToEnd();
	}
	response.Close();
}


I can see that the resolved IP address of the ServicePoint.HostEntry proeprty isn't changing.  I have to use reflection to get the value of the internal ServicePoint.HostEntry property:

// r is the same instance of HttpWebRequest as above
var sp = r.ServicePoint;
var pi = r.ServicePoint.GetType().GetProperty("HostEntry", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.GetProperty | System.Reflection.BindingFlags.Instance);
var ipHostEntry = pi.GetValue(r.ServicePoint) as IPHostEntry;
var IPs = string.Join("; ", ipHostEntry.AddressList.Select(s =&gt; s.ToString()));  
Debug.WriteLine("Host IPs: " + IPs);  // Always outputs the IP address that was resolved during the first call

If I inject this with the reflection code before making the call, I can manually update the HostEntry which will allow the call to succeed:

var actualIPs = Dns.GetHostAddresses("api-stg.flightdocs.com");
ipHostEntry.AddressList = new IPAddress[]{ actualIPs[0] };

I still think this is a bug.  Am I missing something?</pre>
    </div>

    <div id="c35" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-01 16:33:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">If you keep "r" alive, that will keep the ServicePoint alive, so it is normal for it to not be discarded.

What you need is to create a new HttpWebRequest, which will at this point, not use the same ServicePoint.

See:

<a href="http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.maxservicepointidletime%28v=vs.110%29.aspx">http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.maxservicepointidletime%28v=vs.110%29.aspx</a></pre>
    </div>

    <div id="c36" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">kpickard@flightdocs.com</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-01 16:45:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">I'm doing this before any call:

ServicePointManager.MaxServicePointIdleTime = 500; 

And I'm creating a new instance of HttpWebRequest for every call:

HttpWebRequest r = new HttpWebRequest(uri);

In addition to always setting r.KeepAlive = false;

Somehow every new instance of HttpWebRequest ends up with the same service point instance that was previously used.  I'm guessing that internally HttpWebRequest calls ServicePointManager.FindServicePoint(hostName) which always returns the same ServicePoint instance.</pre>
    </div>

    <div id="c37" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-03 15:33:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">What you are doing looks right.

Martin says that it is ok to reuse the same ServicePoint, and even the WebConnectionGroup, what will not be the same is the WebConnection (which is the underlying transport).</pre>
    </div>

    <div id="c38" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Alain</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-05 10:01:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel,

Hello,

I added webRequest.KeepAlive = false;

and I still have the same problem. When I switche from one network to another (WIFI =&gt; 4G or 4G to Wi-Fi). I have a TimeOut connection.

Here's what I do:

[System.Web.Services.WebServiceBinding(Name="ServiceSoap", Namespace="<a href="http://tempuri.org/">http://tempuri.org/</a>")]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
public class MedinectWebServiceExt : DLLMedinect.MedinectWebService.Service
{

    protected override System.Net.WebRequest GetWebRequest(Uri uri)
    {
		ServicePointManager.MaxServicePointIdleTime = 500;

        System.Net.HttpWebRequest webRequest = (System.Net.HttpWebRequest)base.GetWebRequest(uri);

        webRequest.KeepAlive = false; 
       
        return webRequest;
    }
}


and I call my webservice like this:

MedinectWebServiceExt  medinectWBS = new MedinectWebServiceExt();

lstEmail = medinectWBS.GetListMails(strNumeroINAMI.Substring(0,8),true,ref strErreur);


You have to find a solution because our customers do not understand why they have to close the application and restart it for it to work.

thank you

Alain</pre>
    </div>

    <div id="c39" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Andersen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-05 09:52:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">This is truly a serious problem.

It basically eliminates the possibility to use a lot of frameworks that relies on HttpClient. Especially using SignalR is not possible, if you have an environment that switches between wireless and 3g/4g

We just had a serious problem with a customer using SignalR (it is already in use on other devices (non-iOS, such as JavaScript/web and .NET applications)) - we are having to rewrite the iOS-application completely</pre>
    </div>

    <div id="c40" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Miguel de Icaza [MSFT]</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-05 09:56:39 UTC
        </span>

      </div>




<pre class="bz_comment_text">Simon,

Did you read <a href="bug.html">comment #12</a>?

Because if your application uses HttpClient, you *can* use the native CFNetwork handler:

<a href="http://tirania.org/monomac//archive/2013/Jun.html">http://tirania.org/monomac//archive/2013/Jun.html</a>

or the NSURLSession-based handler that plug right into HttpClient with support for OkHttp on Android as well:

<a href="https://github.com/paulcbetts/ModernHttpClient">https://github.com/paulcbetts/ModernHttpClient</a></pre>
    </div>

    <div id="c41" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Andersen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-05 11:05:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel,

Yes - CFNetworkHandler and ModernHttpClient does not support NTLM (to my knowledge), and this is a requirement in most enterprise environments.</pre>
    </div>

    <div id="c42" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Simon Andersen</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-03-05 13:48:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">Miguel,

We made it work!

Thanks alot for pointing me in the correct way.

To all others who might be interested:

We ended up using ModernHttpClient and implemented NTLM-authentication on didReceiveChallenge

We changed SignalR's DefaultHttpClient to a custom HttpClient using NativeMessageHandler (ModernHttpClient)

Connections between Wifi / 3G and even between different IP's to same DNS (please see <a href="mailto:kpickard@flightdocs.com">kpickard@flightdocs.com</a> comments) works perfectly with ModernHttpClient.</pre>
    </div>

    <div id="c43" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Adam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-10-06 02:28:51 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hi, has this issue recently re-appeared?
I have just updated my Xamari iOS, and this issue has appeared - but I have never experienced this before.

We are noticing, if the user makes a network request on WIFI, then the network drops back to Cellular before the request has completed, the request times out.
If, Wifi is reinstated before the timeout, then the socket is re-established and the request completes successfully (albeit, after a very long delay).

This appears to have shown up only in the latest Xamarin, as we have been holding off releasing due to another bug, but now cannot release because of this.

Thanks,</pre>
    </div>

    <div id="c44" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a href="bug.html">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastien Pouliot</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-12-22 14:21:08 UTC
        </span>

      </div>




<pre class="bz_comment_text">@Adam, I suspect this is a dupe #45761 but that did not affect the native handlers [1](which is what was discussed in earlier comments). 

A mono BCL bug affected the managed stack (e.g. WebClient and the default handler for HttpClient) and has been fixed. The next alpha (C9) release will have this fix.

[1] <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed" title="RESOLVED DUPLICATE - Http requests do not work when wifi is toggled off and back on" href="https://bugzilla.xamarin.com/show_bug.cgi?id=46792#c3">https://bugzilla.xamarin.com/show_bug.cgi?id=46792#c3</a>

*** This bug has been marked as a duplicate of <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed" title="VERIFIED FIXED - After network reconnected, web request fails for a couple of minutes with a NameResolutionFailure" href="https://bugzilla.xamarin.com/show_bug.cgi?id=45761">bug 45761</a> ***</pre>
    </div>




</td>
<td>
</td>
</tr></tbody></table>
  </div>


</form>

<hr>


<br>
</div>

    

  
</body></html>
